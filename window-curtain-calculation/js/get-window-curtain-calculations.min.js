$(function(){function H(b,a,c){var d=a.closest("form"),g=d.find(".checkbox-input"),f=d.parents(".window-curtain-calculation-quote-items-body").find(".checkbox-input:checked");$.ajax({url:"window-curtain-calculation/scripts/get-window-curtain-calculation-fabric-options.php",type:"POST",dataType:"json",data:{code:b},beforeSend:function(){a.find("option:not(:first)").remove();a.addClass("field-loader")},success:function(b){if(4===b[0])document.location.replace(b[1]);else if(2===b[0])a.removeClass("field-loader"),
alert(b[1]);else if(1===b[0]){var e="";$.each(b[1],function(a,b){e+='<option value="'+b.name+"<->"+b.width+"<->"+b.code+'" data-code="'+b.code+'" data-width="'+b.width+'" data-price="'+b.price+'" data-supplier="'+b.supplier_code+'">'+b.name+" - "+b.width+" - $"+b.price+" </option>"});g.is(":checked")&&f.length?(f.each(function(){var a=$(this).parents(".update-window-curtain-calculation-quote-item-form"),b=a.find(".window-curtain-calculation-fabric");a=a.find(".window-curtain-calculation-fabric-colour");
var h=d.find(".window-curtain-calculation-width");b.find("option:not(:first)").remove().end().append(e).removeClass("field-loader").val(c);a.val("");h.change()}),e=""):(b=d.find(".window-curtain-calculation-fabric-colour"),a.find("option:not(:first)").remove().end().append(e).removeClass("field-loader").val(c),b.val(""))}else a.removeClass("field-loader"),alert(JSON.stringify(b))},error:function(b,c,d){a.removeClass("field-loader");alert(JSON.stringify(b));alert("Error! @get-window-curtain-calculation-fabric-options")}})}
function I(b,a,c){var d=a.closest("form"),g=d.find(".window-curtain-calculation-fabric").val(),f=d.find(".checkbox-input"),h=d.parents(".window-curtain-calculation-quote-items-body").find(".checkbox-input:checked");$.ajax({url:"window-curtain-calculation/scripts/get-window-curtain-calculation-fabric-colour-options.php",type:"POST",dataType:"json",data:{code:b},beforeSend:function(){a.find("option:not(:first)").remove();a.addClass("field-loader")},success:function(b){if(4===b[0])document.location.replace(b[1]);
else if(2===b[0])a.removeClass("field-loader"),alert(b[1]);else if(1===b[0]){var e="";$.each(b[1],function(a,b){e+='<option value="'+b.name+"<->"+b.code+'" data-code="'+b.code+'" data-fabric="'+b.fabric_code+'">'+b.name+" </option>"});f.is(":checked")&&h.length?(h.each(function(){var a=$(this).parents(".update-window-curtain-calculation-quote-item-form"),b=a.find(".window-curtain-calculation-fabric");a=a.find(".window-curtain-calculation-fabric-colour");var h=d.find(".window-curtain-calculation-width");
b.val(g);a.find("option:not(:first)").remove().end().append(e).removeClass("field-loader").val(c);h.change()}),e=""):a.find("option:not(:first)").remove().end().append(e).removeClass("field-loader").val(c)}else a.removeClass("field-loader"),alert(JSON.stringify(b))},error:function(b,c,d){a.removeClass("field-loader");alert(JSON.stringify(b));alert("Error! @get-window-curtain-calculation-fabric-colour-options")}})}function q(b){b=$(b);var a=b.find("option:selected"),c=b.parents("form");"curtain_type_1"===
b.attr("data-column")&&""!==a.val()&&c.find(".window-curtain-calculation-curtain-type-2").val("");"curtain_type_2"===b.attr("data-column")&&""!==a.val()&&c.find(".window-curtain-calculation-curtain-type-1").val("")}function w(b){var a=$(b).parents("form"),c=a.find(".window-curtain-calculation-qty-drop"),d=a.find(".window-curtain-calculation-continuous-meter"),g=a.find(".window-curtain-calculation-fabric-cut-length"),f=a.find(".window-curtain-calculation-fabric-qty");b=a.find(".window-curtain-calculation-price");
var h=a.find(".window-curtain-calculation-field"),e=a.find(".window-curtain-calculation-code").val(),k=isNaN(a.find(".window-curtain-calculation-width").val())?0:+a.find(".window-curtain-calculation-width").val(),l=isNaN(a.find(".window-curtain-calculation-right-return").val())?0:+a.find(".window-curtain-calculation-right-return").val(),n=isNaN(a.find(".window-curtain-calculation-left-return").val())?0:+a.find(".window-curtain-calculation-left-return").val(),m=isNaN(a.find(".window-curtain-calculation-overlap").val())?
0:+a.find(".window-curtain-calculation-overlap").val(),r=isNaN(a.find(".window-curtain-calculation-fullness").val())?1:+a.find(".window-curtain-calculation-fullness").val(),t=isNaN(a.find(".window-curtain-calculation-fabric option:selected").attr("data-width"))?0:+a.find(".window-curtain-calculation-fabric option:selected").attr("data-width"),y=isNaN(a.find(".window-curtain-calculation-fabric option:selected").attr("data-price"))?0:+a.find(".window-curtain-calculation-fabric option:selected").attr("data-price"),
u=a.find(".window-curtain-calculation-curtain-type-1").val(),z=+a.find(".window-curtain-calculation-curtain-type-1 option:selected").attr("data-price"),v=a.find(".window-curtain-calculation-curtain-type-2").val(),A=+a.find(".window-curtain-calculation-curtain-type-2 option:selected").attr("data-price"),E=isNaN(a.find(".window-curtain-calculation-drop").val())?0:+a.find(".window-curtain-calculation-drop").val(),F=isNaN(a.find(".window-curtain-calculation-hem-heading").val())?0:+a.find(".window-curtain-calculation-hem-heading").val(),
x=isNaN(a.find(".window-curtain-calculation-pattern-repeate").val())||0===+a.find(".window-curtain-calculation-pattern-repeate").val()?1:+a.find(".window-curtain-calculation-pattern-repeate").val();if(""!==e&&0<t){e=+Math.ceil((k+l+n+m)*r/t);k=+((k+l+n+m)*r)/100;c.val(e);d.val(k.toFixed(1));d=+(Math.round((E+F)/x)*x)/100;c=e*d.toFixed(2);""!==u&&d.toFixed(2);""!==v&&k.toFixed(1);g.val(isNaN(d)?"0":d.toFixed(2));f.val(isNaN(c)?"0":c.toFixed(2));f=g="";""!==u&&(g=z,f=e);""!==v&&(g=A,f=k.toFixed(1));
var B=0;$.each(h,function(){var a=$(this).val().split("<->")[2];B+=0<a?+a:0});if("1"!==quote_status||a.hasClass("add-window-curtain-calculation-quote-item-form"))a=y*c+g*f+ +B,b.val(isNaN(a)?"0.00":a.toFixed(2))}else c.val(""),d.val(""),g.val(""),f.val(""),b.val("")}function C(b,a){a=$(a);var c=a.parents("form"),d=a.parents(".window-curtain-calculation-add-field-option-wrapper"),g=d.find(".window-curtain-calculation-add-field-option"),f=d.find(".window-curtain-calculation-add-field-option-submit"),
h=d.siblings(".window-curtain-calculation-field"),e=h.attr("data-code");a=c.find(".window-curtain-calculation-code").val();var k=c.find(".data-field, .number-input, select, [type='submit']");b&&$.ajax({url:"window-curtain-calculation/scripts/add-window-curtain-calculation-field-option.php",type:"POST",dataType:"json",data:{field_code:e,field_option_name:b,window_curtain_calculation_code:a},beforeSend:function(){g.prop("disabled",!0).addClass("field-loader");f.prop("disabled",!0).addClass("field-loader")},
success:function(a){if(4===a[0])document.location.replace(a[1]);else if(2===a[0])alert(a[1]);else if(1===a[0]){$(".window-curtain-calculation-add-field-option-x[data-field-code="+e+"]").before('<option value="'+a[2]+"<->"+a[1]+'<->0.00">'+a[2]+"</option>");var b=c.find(".checkbox-input"),l=c.parents(".window-curtain-calculation-quote-items-body").find(".checkbox-input:checked");b.is(":checked")&&l.length&&l.not(b).each(function(){$(this).parents(".update-window-curtain-calculation-quote-item-form").find(".data-field, .number-input, select, [type='submit']").prop("disabled",
!1)});g.val("");d.hide();k.prop("disabled",!1);h.show().val(a[2]+"<->"+a[1]+"<->0.00").change()}else alert(a);g.prop("disabled",!1).removeClass("field-loader");f.prop("disabled",!1).removeClass("field-loader")},error:function(a,b,c){g.prop("disabled",!1).removeClass("field-loader");f.prop("disabled",!1).removeClass("field-loader")}})}function p(b){b=$(b).parents(".window-curtain-calculation-quote-items-wrapper");var a=b.find(".window-curtain-calculation-quote-items-body").find("input[name='price']:not(:hidden)"),
c=$.isNumeric(+b.find(".group-discount").val())?+b.find(".group-discount").val():0,d=0;a.each(function(){d+=Number($(this).val().replace(/,/g,""))});a=d-d*c/100;b.find(".group-total").val(d.toFixed(2)).end().find(".group-discount").val(c).end().find(".group-discount-total").html(a.toFixed(2)).end().find(".group-discount-form").submit()}$.ajax({url:"window-curtain-calculation/scripts/get-window-curtain-calculations.php",type:"POST",dataType:"json",data:{cid},beforeSend:function(){},success:function(b){4===
b[0]?document.location.replace(b[1]):2===b[0]?alert(b[1]):1===b[0]?($.each(b[1],function(a,c){var d=c.code;if(1===c.location_select){a="<th>Locations</th>";var g="";$.each(b[2],function(a,b){g+='<option value="'+b.name+"<->"+b.code+'">'+b.name+"</option>"});var f='<td>\n                                                    <select name="location" data-column="location" class="window-curtain-calculation-location data-field">\n                                                        <option value=""></option>\n                                                        '+
g+"                                                    </select>\n                                                </td>"}else f=g=a="";var h="",e="";$.each(c.supplier_options,function(a,b){h+='<option value="'+b.name+"<->"+b.code+'" data-code="'+b.code+'">'+b.name+"</option>"});e='<td>\n                                        <select name="supplier" data-column="supplier" class="window-curtain-calculation-supplier data-field">\n                                            <option value=""></option>\n                                            '+
h+"                                        </select>\n                                    </td>";var k="";k='<td>\n                                        <select name="fabric" data-column="fabric" class="window-curtain-calculation-fabric data-field">\n                                            <option value=""></option>\n                                        </select>\n                                    </td>';var l="";l='<td>\n                                        <select name="fabric_colour" data-column="fabric_colour" class="window-curtain-calculation-fabric-colour data-field">\n                                            <option value=""></option>\n                                        </select>\n                                    </td>';
var n="",m="";$.each(c.curtain_type_1_options,function(a,b){n+='<option value="'+b.name+"<->"+b.price+"<->"+b.code+'" data-code="'+b.code+'" data-price="'+b.price+'">'+b.name+" - $"+b.price+" </option>"});m='<td>\n                                        <select name="curtain_type_1" data-column="curtain_type_1" class="window-curtain-calculation-curtain-type-1 data-field">\n                                            <option value=""></option>\n                                            '+n+"                                        </select>\n                                    </td>";
var r="",t="";$.each(c.curtain_type_2_options,function(a,b){r+='<option value="'+b.name+"<->"+b.price+"<->"+b.code+'" data-code="'+b.code+'" data-price="'+b.price+'">'+b.name+" - $"+b.price+" </option>"});t='<td>\n                                        <select name="curtain_type_2" data-column="curtain_type_2" class="window-curtain-calculation-curtain-type-2 data-field">\n                                            <option value=""></option>\n                                            '+r+"                                        </select>\n                                    </td>";
var y="",u="",z="",v="";$.each(c.fields,function(a,b){if(1===b.side)if(y+="<th>"+b.name+"</th>",0===b.field_type){var c="";$.each(b.options,function(b,a){c+='<option value="'+a.name+"<->"+a.code+"<->"+a.price+'">'+a.name+(0<a.price?" | "+a.price:"")+"</option>"});c+='<option class="window-curtain-calculation-add-field-option-x" data-field-code="'+b.code+'" value="add-new">Add New</option>';u+='<td>\n                                                        <select name="field['+b.code+']" data-code="'+
b.code+'" data-column="field-'+b.code+'" class="window-curtain-calculation-field data-field">\n                                                            <option value=""></option>\n                                                            '+c+'                                                        </select>\n                                                        <span class="window-curtain-calculation-add-field-option-wrapper">\n                                                            <input type="text" class="window-curtain-calculation-add-field-option text-input">\n                                                            <input type="button" class="window-curtain-calculation-add-field-option-submit bttn-input" value="\u271a">\n                                                            <input type="button" class="window-curtain-calculation-add-field-option-close bttn-input" value="\u2716">\n                                                        </span>\n                                                    </td>'}else u+=
'<td>\n                                                        <input type="text" name="field['+b.code+']" data-code="'+b.code+'" data-column="field-'+b.code+'" class="window-curtain-calculation-field data-field text-field" autocomplete="off">\n                                                    </td>';0===b.side&&(z+="<th>"+b.name+"</th>",0===b.field_type?(c="",$.each(b.options,function(b,a){c+='<option value="'+a.name+"<->"+a.code+"<->"+a.price+'">'+a.name+(0<a.price?" | "+a.price:"")+"</option>"}),
c+='<option class="window-curtain-calculation-add-field-option-x" data-field-code="'+b.code+'" value="add-new">Add New</option>',v+='<td>\n                                                            <select name="field['+b.code+']" data-code="'+b.code+'" data-column="field-'+b.code+'" class="window-curtain-calculation-field data-field">\n                                                                <option value=""></option>\n                                                                '+c+'                                                            </select>\n                                                            <span class="window-curtain-calculation-add-field-option-wrapper">\n                                                                <input type="text" class="window-curtain-calculation-add-field-option text-input">\n                                                                <input type="button" class="window-curtain-calculation-add-field-option-submit bttn-input" value="\u271a">\n                                                                <input type="button" class="window-curtain-calculation-add-field-option-close bttn-input" value="\u2716">\n                                                            </span>\n                                                        </td>'):
v+='<td>\n                                                            <input type="text" name="field['+b.code+']" data-code="'+b.code+'" data-column="field-'+b.code+'" class="window-curtain-calculation-field data-field text-field" autocomplete="off">\n                                                        </td>')});if(1===c.accessories_select){var A="",E="",F='<input type="hidden" class="accessory-option-array" value=\''+JSON.stringify(c.accessory_options)+"'>";$.each(c.accessory_options,function(a,
b){E+='<option data-code="'+b.code+'" value="'+b.code+"<->"+b.name+"<->"+b.price+'">'+b.name+" | "+b.price+"</option>"});A='<span class="window-curtain-calculation-accessories-wrapper">\n                                                <select class="window-curtain-calculation-accessories">\n                                                    <option value="">Accessories</option>\n                                                    '+E+'                                                </select>\n                                                <input type="tel" class="add-window-curtain-calculation-accessory-qty qty-input" placeholder="Qty">\n                                                <input type="button" class="add-window-curtain-calculation-accessories bttn-input" value="\u271a">\n                                            </span>'}else F=
A="";if(1===c.per_meters_select){var x="",B="",p='<input type="hidden" class="per-meter-option-array" value=\''+JSON.stringify(c.per_meter_options)+"'>";$.each(c.per_meter_options,function(b,a){B+='<option data-code="'+a.code+'" value="'+a.code+"<->"+a.name+"<->"+a.price+'">'+a.name+" | "+a.price+"</option>"});x='<span class="window-curtain-calculation-per-meters-wrapper">\n                                                <select class="window-curtain-calculation-per-meters">\n                                                    <option value="">Per Meters</option>\n                                                    '+
B+'                                                </select>\n                                                <input type="tel" class="add-window-curtain-calculation-per-meter-width qty-input" placeholder="Width">\n                                                <input type="button" class="add-window-curtain-calculation-per-meters bttn-input" value="\u271a">\n                                            </span>'}else p=x="";if(1===c.fitting_charges_select){var q="",w="",C='<input type="hidden" class="fitting-charge-option-array" value=\''+
JSON.stringify(c.fitting_charge_options)+"'>";$.each(c.fitting_charge_options,function(a,b){w+='<option data-code="'+b.code+'" value="'+b.code+"<->"+b.name+"<->"+b.price+'">'+b.name+" | "+b.price+"</option>"});q='<span class="window-curtain-calculation-fitting-charges-wrapper">\n                                                    <select class="window-curtain-calculation-fitting-charges">\n                                                        <option value="">Fitting Charges</option>\n                                                        '+
w+'                                                    </select>\n                                                    <input type="button" class="add-window-curtain-calculation-fitting-charges bttn-input" value="\u271a">\n                                                </span>'}else C=q="";1===c.status&&($('<li><a href="#tab-'+c.code+'">'+c.name+"</a></li>").prependTo("#window-curtain-calculation-tabs .tabs ul"),$('<div id="tab-'+c.code+'" class="window-curtain-calculation-tab-div"></div>').append($('<form class="add-window-curtain-calculation-quote-item-form" action="./" method="POST"></form>').append('<input type="hidden" class="cid" name="cid" value="'+
cid+'">').append('<input type="hidden" class="window-curtain-calculation-code" name="window-curtain-calculation-code" value="'+d+'">').append($('<table class="window-curtain-calculation-table"></table>').append($('<thead class="thead"></thead>').append($('<tr class="thead-tr"></tr>').append(y).append(a).append("<th>Width</th>").append("<th>R Returns</th>").append("<th>L Returns</th>").append("<th>Overlap</th>").append("<th>Fullness</th>").append("<th>Supplier</th>").append("<th>Fabric</th>").append("<th>Colour</th>").append("<th>Qty Drops</th>").append("<th>Curtain Type 1</th>").append("<th>Cont. Meters</th>").append("<th>Curtain Type 2</th>").append("<th>Height</th>").append("<th>Hem/Heading</th>").append("<th>Pattern Repeate</th>").append("<th>Fab. Cut Legnth</th>").append("<th>Fab. Qty</th>").append(z).append('<th>\n                                                        <table class="right-fixed-column">\n                                                            <tr>\n                                                                <th>Price</th>\n                                                                <th>Qty</th>\n                                                                <th>Add</th>\n                                                            </tr>\n                                                        </table>\n                                                    </th>'))).append($("<tbody></tbody>").append($('<tr class="tbody-tr"></tr>').append(u).append(f).append('<td><input type="tel" name="width" data-column="width" class="window-curtain-calculation-width number-input data-field" maxlength="4" autocomplete="off" min="0" placeholder="cm"></td>').append('<td><input type="tel" name="right_return" data-column="right_return" class="window-curtain-calculation-right-return number-input data-field" maxlength="7" autocomplete="off" min="0"></td>').append('<td><input type="tel" name="left_return" data-column="left_return" class="window-curtain-calculation-left-return number-input data-field" maxlength="7" autocomplete="off" min="0"></td>').append('<td><input type="tel" name="overlap" data-column="overlap" class="window-curtain-calculation-overlap number-input data-field" maxlength="7" autocomplete="off" min="0"></td>').append('<td><input type="tel" name="fullness" data-column="fullness" class="window-curtain-calculation-fullness number-input data-field" maxlength="7" autocomplete="off" min="0"></td>').append(e).append(k).append(l).append('<td><input type="tel" name="qty_drop" data-column="qty_drop" class="window-curtain-calculation-qty-drop number-input data-field" maxlength="4" autocomplete="off" min="0" style="background: #eee;" readonly></td>').append(m).append('<td><input type="tel" name="continuous_meter" data-column="continuous_meter" class="window-curtain-calculation-continuous-meter number-input data-field" maxlength="4" autocomplete="off" min="0" style="background: #eee;" readonly></td>').append(t).append('<td><input type="tel" name="drop" data-column="drop_x" class="window-curtain-calculation-drop number-input data-field" maxlength="4" autocomplete="off" min="0" placeholder="cm"></td>').append('<td><input type="tel" name="hem_heading" data-column="hem_heading" class="window-curtain-calculation-hem-heading number-input data-field" maxlength="4" autocomplete="off" min="0"></td>').append('<td><input type="tel" name="pattern_repeate" data-column="pattern_repeate" class="window-curtain-calculation-pattern-repeate number-input data-field" maxlength="4" autocomplete="off" min="0"></td>').append('<td><input type="tel" name="fabric_cut_length" data-column="fabric_cut_length" class="window-curtain-calculation-fabric-cut-length number-input data-field" maxlength="4" autocomplete="off" min="0" style="background: #eee;" readonly></td>').append('<td><input type="tel" name="fabric_qty" data-column="fabric_qty" class="window-curtain-calculation-fabric-qty number-input data-field" maxlength="4" autocomplete="off" min="0" style="background: #eee;" readonly></td>').append(v).append('<td>\n                                                        <table class="right-fixed-column" style="margin-top: -20px;">\n                                                            <tr>\n                                                                <td><input type="tel" name="price" class="window-curtain-calculation-price price-input data-field" autocomplete="off"></td>\n                                                                <td><input type="number" name="qty" class="window-curtain-calculation-qty number-input" autocomplete="off" min="1" value="1"></td>\n                                                                <td><input type="submit" class="bttn-input" value="\u271a"></td>\n                                                            </tr>\n                                                        </table>\n                                                    </td>')))).append(F).append(p).append(C)).prependTo("#window-curtain-calculation-tabs .calculation-results").find(".bttn-input").button());
if("[]"!==JSON.stringify(c.quote_items)){$('<div id="window-curtain-calculation-quote-items-wrapper-'+d+'" class="window-curtain-calculation-quote-items-wrapper"></div>').append('<h2 class="window-curtain-calculation-header">'+c.name+"</h2>").append('<div id="quote-items-body-'+d+'" class="window-curtain-calculation-quote-items-body"></div>').append('<div class="bulk-action-button-wrapper">\n                                        <input type="button" class="bulk-action-button window-curtain-calculation-select-all-bttn" value="\u2714">\n                                        <input type="button" class="bulk-action-button window-curtain-calculation-bulk-delete-bttn" value="Delete">\n                                        <input type="button" class="bulk-action-button window-curtain-calculation-bulk-copy-bttn" value="Copy">\n                                        <a href="print/order-sheet-window-curtain-calculation-'+
d+"-"+cid+'" target="_blank" class="bulk-action-button print-bttn" style="width: 145px;">Print Order Sheet</a>\n                                        <a href="https://file-gen.blinq.com.au/clients/'+user_account+"/order-sheet-xlsx-window-curtain-calculation-"+d+"-"+cid+'" target="_blank" class="bulk-action-button print-bttn" style="width: 175px;">Print Order Sheet Xlsx</a>\n                                        <form class="group-discount-form" style="float: right; margin-right: -6px; font-size: 12px;">\n                                            <input type="tel" class="group-total price-input ui-state-default" autocomplete="off" style="float: left;" disabled>\n                                            <input type="tel" class="group-discount price-input ui-state-default" autocomplete="off" placeholder="%" style="float: left; margin-left: 1px !important; margin-right: 1px !important; text-align: center; width: 33px;" required>\n                                            <input type="hidden" class="window-curtain-calculation-code" value="'+
d+'">\n                                            <input type="submit" class="bttn-input ui-button ui-widget ui-state-default ui-corner-all" value="\u2714" role="button" aria-disabled="false" style="float: left;">\n                                        </form>\n                                        <div class="group-discount-total" style="float: right; line-height: 40px; margin-right: 400px; font-size: 22px; font-weight: bold;"></div>\n                                        </div>').prependTo("#window-curtain-calculation-quote-items-results").find(".bttn-input, .bulk-action-button").button();
a='<tr class="thead-tr">\n                                                <th class="left-fixed-column">#</th>\n                                                '+y+"                                                "+a+"                                                <th>Width</th>\n                                                <th>R Returns</th>\n                                                <th>L Returns</th>\n                                                <th>Overlap</th>\n                                                <th>Fullness</th>\n                                                <th>Supplier</th>                                                <th>Fabric</th>                                                <th>Colour</th>                                                <th>Qty Drops</th>\n                                                <th>Curtain Type 1</th>                                                <th>Cont. Meters</th>\n                                                <th>Curtain Type 2</th>                                                <th>Height</th>\n                                                <th>Hem/Heading</th>\n                                                <th>Pattern Repeate</th>\n                                                <th>Fab. Cut Legnth</th>\n                                                <th>Fab. Qty</th>\n                                                "+
z+'                                                <th>\n                                                    <table class="right-fixed-column">\n                                                        <tr>\n                                                            <th>Price</th>\n                                                            <th>More</th>\n                                                            <th>Del</th>\n                                                        </tr>\n                                                    </table>\n                                                </th>\n                                            </tr>';
var J=1,D=0,G=0;$.each(c.quote_items,function(b,a){$('<form id="calculation-form-'+a.code+'" class="update-window-curtain-calculation-quote-item-form" action="./" method="POST">\n                                    <input type="hidden" name="cid" class="cid" value="'+cid+'">\n                                    <input type="hidden" name="window-curtain-calculation-code" class="window-curtain-calculation-code" value="'+d+'">\n                                    <input type="hidden" name="window-curtain-calculation-quote-item-code" class="window-curtain-calculation-quote-item-code" value="'+
a.code+'">\n                                    <table class="window-curtain-calculation-table">\n                                        <thead class="thead"></thead>\n                                        <tbody>\n                                            <tr>\n                                                <td class="left-fixed-column">\n                                                    <label class="checkbox-label" for="checkbox-'+a.code+'">'+J+'</label>\n                                                    <input type="checkbox" id="checkbox-'+
a.code+'"class="checkbox-input" name="quote-item-codes[]" value="'+a.code+'">\n                                                </td>\n                                                '+u+"                                                "+f+'                                                <td><input type="tel" name="width" data-column="width" class="window-curtain-calculation-width number-input data-field" maxlength="4" autocomplete="off" min="0" value="'+a.width+'" placeholder="cm"></td>\n                                                <td><input type="tel" name="right_return" data-column="right_return" class="window-curtain-calculation-right-return number-input data-field" maxlength="7" autocomplete="off" min="0" value="'+
a.right_return+'"></td>\n                                                <td><input type="tel" name="left_return" data-column="left_return" class="window-curtain-calculation-left-return number-input data-field" maxlength="7" autocomplete="off" min="0" value="'+a.left_return+'"></td>\n                                                <td><input type="tel" name="overlap" data-column="overlap" class="window-curtain-calculation-overlap number-input data-field" maxlength="7" autocomplete="off" min="0" value="'+
a.overlap+'"></td>\n                                                <td><input type="tel" name="fullness" data-column="fullness" class="window-curtain-calculation-fullness number-input data-field" maxlength="7" autocomplete="off" min="0" value="'+a.fullness+'"></td>\n                                                '+e+"                                                "+k+"                                                "+l+'                                                <td><input type="tel" name="qty_drop" data-column="qty_drop" class="window-curtain-calculation-qty-drop number-input data-field" maxlength="7" autocomplete="off" min="0" value="'+
a.qty_drop+'" style="background: #eee;" readonly></td>\n                                                '+m+'                                                <td><input type="tel" name="continuous_meter" data-column="continuous_meter" class="window-curtain-calculation-continuous-meter number-input data-field" maxlength="7" autocomplete="off" min="0" value="'+a.continuous_meter+'" style="background: #eee;" readonly></td>\n                                                '+t+'                                                <td><input type="tel" name="drop" data-column="drop_x" class="window-curtain-calculation-drop number-input data-field" maxlength="4" autocomplete="off" min="0" value="'+
a.drop+'" placeholder="cm"></td>\n                                                <td><input type="tel" name="hem_heading" data-column="hem_heading" class="window-curtain-calculation-hem-heading number-input data-field" maxlength="4" autocomplete="off" min="0" value="'+a.hem_heading+'"></td>\n                                                <td><input type="tel" name="pattern_repeate" data-column="pattern_repeate" class="window-curtain-calculation-pattern-repeate number-input data-field" maxlength="4" autocomplete="off" min="0" value="'+
a.pattern_repeate+'"></td>\n                                                <td><input type="tel" name="fabric_cut_length" data-column="fabric_cut_length" class="window-curtain-calculation-fabric-cut-length number-input data-field" maxlength="4" autocomplete="off" min="0" value="'+a.fabric_cut_length+'" style="background: #eee;" readonly></td>\n                                                <td><input type="tel" name="fabric_qty" data-column="fabric_qty" class="window-curtain-calculation-fabric-qty number-input data-field" maxlength="4" autocomplete="off" min="0" value="'+
a.fabric_qty+'" style="background: #eee;" readonly></td>\n                                                '+v+'                                                <td>\n                                                    <table class="right-fixed-column" style="margin-top: -20px;">\n                                                        <tr>\n                                                            <td><input type="tel" name="price" data-column="price" class="window-curtain-calculation-price price-input data-field ui-state-default" autocomplete="off" value="'+
a.price+'"></td>\n                                                            <td><input type="button" class="window-curtain-calculation-table-more-bttn bttn-input" value="\u2605"></td>\n                                                            <td><input type="button" class="bttn-input delete-window-curtain-calculation-quote-item" value="\u2716"></td>\n                                                        </tr>\n                                                    </table>\n                                                </td>\n                                            </tr>\n                                        </tbody>\n                                    </table>\n                                    <table id="calculation-table-more-'+
a.code+'"  class="window-curtain-calculation-table-more">\n                                        <tr>\n                                            <td class="table-more-notes" colspan="3">\n                                                <textarea name="notes" data-column="notes" class="window-curtain-calculation-notes data-field" placeholder="Notes">'+a.notes+'</textarea>\n                                            </td>\n                                        </tr>\n                                        <tr>\n                                            <td class="table-more-accessories">\n                                                '+
A+'                                            </td>\n                                            <td class="table-more-per-meters">\n                                                '+x+'                                            </td>\n                                            <td class="table-more-fitting-charges">\n                                                '+q+"                                            </td>\n                                        </tr>\n                                    </table>\n                                </form>").appendTo("#quote-items-body-"+
d).queue(function(){var b=$(this),c=b.find("[name='fabric']"),d=b.find("[name='fabric_colour']");b.find("[name='supplier']").val(a.supplier);var e=a.supplier.split("<->")[1],h=a.fabric.split("<->")[2];H(e,c,a.fabric);I(h,d,a.fabric_colour);b.find("[name='curtain_type_1']").val(a.curtain_type_1);b.find("[name='curtain_type_2']").val(a.curtain_type_2);$.each(a.fields,function(a,c){a=c.code;var d=c.name,e=c.price;c=c.window_curtain_calculation_field_code;b.find("[name='field["+c+"]']").is("input")?b.find("[name='field["+
c+"]']").val(d):b.find("[name='field["+c+"]']").val(d+"<->"+a+"<->"+e)});$.each(a.accessories,function(a,c){a=c.code;var d=c.name,e=+c.price;c=+c.qty;var h=(e*c).toFixed(2);b.find(".table-more-accessories").append('<span class="window-curtain-calculation-accessories-wrapper">\n                                                                                            <input type="text" class="window-curtain-calculation-accessory" readonly disabled value="'+d+" | "+e+" x "+c+" = "+h+'">\n                                                                                            <input type="button" class="delete-window-curtain-calculation-accessory bttn-input" data-code="'+
a+'" value="\u2716">\n                                                                                        </span>');b.find('.window-curtain-calculation-accessories option[data-code="'+a+'"]').hide()});$.each(a.per_meters,function(a,c){a=c.code;var d=c.name,e=+c.price;c=+c.width;var h=(e*c).toFixed(2);b.find(".table-more-per-meters").append('<span class="window-curtain-calculation-per-meters-wrapper">\n                                                                                            <input type="text" class="window-curtain-calculation-per-meter" readonly disabled value="'+
d+" | "+e+" x "+c+" = "+h+'">\n                                                                                            <input type="button" class="delete-window-curtain-calculation-per-meter bttn-input" data-code="'+a+'" value="\u2716">\n                                                                                        </span>');b.find('.window-curtain-calculation-per-meters option[data-code="'+a+'"]').hide()});$.each(a.fitting_charges,function(a,c){a=c.code;var d=c.name;c=c.price;b.find(".table-more-fitting-charges").append('<span class="window-curtain-calculation-fitting-charges-wrapper">\n                                                                                                <input type="text" class="window-curtain-calculation-fitting-charge" readonly disabled value="'+
d+" | "+c+'">\n                                                                                                <input type="button" class="delete-window-curtain-calculation-fitting-charge bttn-input" data-code="'+a+'" value="\u2716">\n                                                                                            </span>')});c=a.notes;d=b.find(".window-curtain-calculation-accessory").length;e=b.find(".window-curtain-calculation-per-meter").length;h=b.find(".window-curtain-calculation-fitting-charge").length;
c||d||e||h?b.find(".window-curtain-calculation-table-more-bttn").addClass("red"):b.find(".window-curtain-calculation-table-more-bttn").removeClass("red");J++;D=+D+ +a.price;G=a.discount;b.find(".bttn-input, .checkbox-input").button();b.dequeue()}).clearQueue().html()});$("#window-curtain-calculation-quote-items-wrapper-"+d).find(".group-total").val(D.toFixed(2)).end().find(".group-discount").val(G).end().find(".group-discount-total").html((D-D*G/100).toFixed(2));$(".window-curtain-calculation-quote-items-body .window-curtain-calculation-table .thead").html(a)}else $('<div id="window-curtain-calculation-quote-items-wrapper-'+
d+'" class="window-curtain-calculation-quote-items-wrapper"></div>').append('<h2 class="window-curtain-calculation-header">'+c.name+"</h2>").append('<div id="quote-items-body-'+d+'" class="window-curtain-calculation-quote-items-body"></div>').append('<div class="bulk-action-button-wrapper"></div>').prependTo("#window-curtain-calculation-quote-items-results").hide()}),$(".tabs").tabs("refresh").tabs("option","active",0)):alert(JSON.stringify(b))},error:function(b,a,c){alert(JSON.stringify(b))}});$(document).on("click",
".window-curtain-calculation-select-all-bttn",function(){var b=$(this),a=b.val(),c=b.parents(".window-curtain-calculation-quote-items-wrapper");"\u2714"===a?(c.find(".checkbox-input").prop("checked",!0).change().button("refresh"),b.val("\u2716")):(c.find(".checkbox-input").prop("checked",!1).change().button("refresh"),b.val("\u2714"))});$(document).on("click",".window-curtain-calculation-bulk-delete-bttn",function(){var b=$(this),a=b.parents(".window-curtain-calculation-quote-items-wrapper");a.find(".window-curtain-calculation-table .thead .thead-tr").clone();
var c=a.find(".checkbox-input:checked"),d=c.serialize()+"&cid="+cid;d&&$.ajax({url:"window-curtain-calculation/scripts/delete-bulk-window-curtain-calculation-quote-items.php",type:"POST",dataType:"json",data:d,beforeSend:function(){b.prop("disabled",!1).addClass("field-loader")},success:function(d){4===d[0]?document.location.replace(d[1]):2===d[0]?(b.prop("disabled",!1).removeClass("field-loader"),alert(d[1])):1===d[0]?($.each(c.serializeArray(),function(a,b){$("#calculation-form-"+b.value).remove()}),
a.find(".update-window-curtain-calculation-quote-item-form").length?a.find(".checkbox-label").each(function(a){$(this).find(".ui-button-text").html(a+1)}):a.hide().find(".bulk-action-button-wrapper").empty(),b.prop("disabled",!1).removeClass("field-loader"),p(b),$("#getsum").load("getsum.php?cid="+cid).fadeIn("fast"),$("#totalx").load("megaTotal.php?cid="+cid).fadeIn("fast")):(b.prop("disabled",!1).removeClass("field-loader"),alert(JSON.stringify(d)))},error:function(a,c,d){b.prop("disabled",!1).removeClass("field-loader");
alert(JSON.stringify(a));alert("Error! @delete-bulk-window-curtain-calculation-quote-item")}})});$(document).on("click",".window-curtain-calculation-bulk-copy-bttn",function(){var b=$(this),a=b.parents(".window-curtain-calculation-quote-items-wrapper"),c=a.find(".checkbox-input:checked").serialize()+"&cid="+cid;c&&$.ajax({url:"window-curtain-calculation/scripts/copy-bulk-window-curtain-calculation-quote-items.php",type:"POST",dataType:"json",data:c,beforeSend:function(){b.prop("disabled",!1).addClass("field-loader")},
success:function(c){4===c[0]?document.location.replace(c[1]):2===c[0]?(b.prop("disabled",!1).removeClass("field-loader"),alert(c[1])):1===c[0]?($.each(c[1],function(b,c){var d=$("#calculation-form-"+b).clone();d.attr("id","calculation-form-"+c);d.find(".window-curtain-calculation-quote-item-code").val(c);d.find(".checkbox-label").attr("for","checkbox-"+c);d.find(".checkbox-input").attr("id","checkbox-"+c).val(c);d.find(".checkbox-input").button();d.find(".window-curtain-calculation-table-more").attr("id",
"calculation-table-more-"+c).hide();$(d).appendTo(a.find(".window-curtain-calculation-quote-items-body")).queue(function(){var a=$(this),c=$("#calculation-form-"+b);$.each(c.serializeArray(),function(b,c){a.find(".data-field[name='"+c.name+"']").val(c.value)});a.dequeue()}).clearQueue()}),a.find(".checkbox-label").each(function(a){$(this).find(".ui-button-text").html(a+1)}),b.prop("disabled",!1).removeClass("field-loader"),p(b)):(b.prop("disabled",!1).removeClass("field-loader"),alert(JSON.stringify(c)))},
error:function(a,c,f){b.prop("disabled",!1).removeClass("field-loader");alert(JSON.stringify(a));alert("Error! @delete-bulk-window-curtain-calculation-quote-item")}})});$(document).on("change",".window-curtain-calculation-supplier",function(){var b=$(this).find("option:selected").attr("data-code"),a=$(this).closest("form").find(".window-curtain-calculation-fabric");H(b,a,"")});$(document).on("change",".window-curtain-calculation-fabric",function(){var b=$(this).find("option:selected").attr("data-code"),
a=$(this).closest("form").find(".window-curtain-calculation-fabric-colour");I(b,a,"")});$(document).on("click",".delete-window-curtain-calculation-quote-item",function(){var b=$(this),a=b.parents(".update-window-curtain-calculation-quote-item-form");a=b.parents(".update-window-curtain-calculation-quote-item-form");var c=a.find(".window-curtain-calculation-quote-item-code").val(),d=a.parents(".window-curtain-calculation-quote-items-wrapper");$.ajax({url:"window-curtain-calculation/scripts/delete-window-curtain-calculation-quote-item.php",
type:"POST",dataType:"json",data:{cid,code:c},beforeSend:function(){b.prop("disabled",!0).addClass("field-loader")},success:function(c){4===c[0]?document.location.replace(c[1]):2===c[0]?(b.prop("disabled",!1).removeClass("field-loader"),alert(c[1])):1===c[0]?(a.hide(),b.prop("disabled",!1).removeClass("field-loader"),p(a),$("#getsum").load("getsum.php?cid="+cid).fadeIn("fast"),$("#totalx").load("megaTotal.php?cid="+cid).fadeIn("fast"),a.remove(),d.find(".update-window-curtain-calculation-quote-item-form").length?
d.find(".checkbox-label").each(function(a){$(this).find(".ui-button-text").html(a+1)}):d.hide().find(".bulk-action-button-wrapper").empty()):(b.prop("disabled",!1).removeClass("field-loader"),alert(JSON.stringify(c)))},error:function(a,c,d){b.prop("disabled",!1).removeClass("field-loader");alert(JSON.stringify(a));alert("Error! @delete-bulk-window-curtain-calculation-quote-item")}})});$(document).on("click",".window-curtain-calculation-table-more-bttn",function(){$(this).parents("form").find(".window-curtain-calculation-table-more").toggle("slide",
{direction:"up"},"fast")});$(document).on("change",".checkbox-input",function(){var b=$(this),a=b.parents(".window-curtain-calculation-table");b.is(":checked")?a.find("select, .number-input, .text-field").addClass("ui-state-default"):a.find("select, .number-input, .text-field").removeClass("ui-state-default")});$(document).on("change",".window-curtain-calculation-curtain-type-1, \n                            .window-curtain-calculation-curtain-type-2",function(){q(this)});$(document).on("change",
".add-window-curtain-calculation-quote-item-form .window-curtain-calculation-width, \n                            .add-window-curtain-calculation-quote-item-form .window-curtain-calculation-right-return, \n                            .add-window-curtain-calculation-quote-item-form .window-curtain-calculation-left-return, \n                            .add-window-curtain-calculation-quote-item-form .window-curtain-calculation-overlap, \n                            .add-window-curtain-calculation-quote-item-form .window-curtain-calculation-fullness, \n                            .add-window-curtain-calculation-quote-item-form .window-curtain-calculation-supplier, \n                            .add-window-curtain-calculation-quote-item-form .window-curtain-calculation-fabric, \n                            .add-window-curtain-calculation-quote-item-form .window-curtain-calculation-curtain-type-1, \n                            .add-window-curtain-calculation-quote-item-form .window-curtain-calculation-curtain-type-2, \n                            .add-window-curtain-calculation-quote-item-form .window-curtain-calculation-drop, \n                            .add-window-curtain-calculation-quote-item-form .window-curtain-calculation-hem-heading, \n                            .add-window-curtain-calculation-quote-item-form .window-curtain-calculation-pattern-repeate, \n                            .add-window-curtain-calculation-quote-item-form .window-curtain-calculation-field",
function(){w(this)});$(document).on("change",".window-curtain-calculation-field",function(b){var a=$(this),c=a.parents("form");b=a.siblings(".window-curtain-calculation-add-field-option-wrapper");var d=b.find(".window-curtain-calculation-add-field-option"),g=c.find(".data-field, .number-input, select, [type='submit']"),f=c.find(".checkbox-input");c=c.parents(".window-curtain-calculation-quote-items-body").find(".checkbox-input:checked");f.is(":checked")&&c.length&&c.not(f).each(function(){var b=$(this).parents(".update-window-curtain-calculation-quote-item-form").find(".data-field, .number-input, select, [type='submit']");
"add-new"===a.val()&&b.prop("disabled",!0)});"add-new"===a.val()&&(a.hide(),b.show(),d.focus(),g.prop("disabled",!0))});$(document).on("keypress",".window-curtain-calculation-add-field-option",function(b){if(13===b.keyCode){b.preventDefault();b=$(this);var a=b.parents(".window-curtain-calculation-add-field-option-wrapper").find(".window-curtain-calculation-add-field-option").val();C(a,b);return!1}});$(document).on("click",".window-curtain-calculation-add-field-option-submit",function(b){b.preventDefault();
b=$(this);var a=b.siblings(".window-curtain-calculation-add-field-option").val();C(a,b);return!1});$(document).on("click",".window-curtain-calculation-add-field-option-close",function(){var b=$(this),a=b.parents("form");b=b.parents(".window-curtain-calculation-add-field-option-wrapper");var c=b.find(".window-curtain-calculation-add-field-option"),d=b.siblings(".window-curtain-calculation-field"),g=a.find(".data-field, .number-input, select, [type='submit']"),f=a.find(".checkbox-input");a=a.parents(".window-curtain-calculation-quote-items-body").find(".checkbox-input:checked");
f.is(":checked")&&a.length&&a.not(f).each(function(){$(this).parents(".update-window-curtain-calculation-quote-item-form").find(".data-field, .number-input, select, [type='submit']").prop("disabled",!1)});c.val("");b.hide();g.prop("disabled",!1);d.show().val("").change().focus()});$(document).on("submit",".add-window-curtain-calculation-quote-item-form",function(b){b.preventDefault();var a=$(this),c=a.find('[type="submit"]'),d=a.find(".window-curtain-calculation-table .thead-tr"),g=a.find(".window-curtain-calculation-table .tbody-tr"),
f=a.find(".window-curtain-calculation-code").val(),h=a.find(".accessory-option-array").val(),e=a.find(".per-meter-option-array").val(),k=a.find(".fitting-charge-option-array").val(),l=$("#window-curtain-calculation-quote-items-wrapper-"+f),n=$.isNumeric(+l.find(".group-discount").val())?+l.find(".group-discount").val():0;b=a.serialize();$.ajax({url:"window-curtain-calculation/scripts/add-window-curtain-calculation-quote-item.php",type:"POST",dataType:"json",data:b,beforeSend:function(a){c.prop("disabled",
!1).addClass("field-loader")},success:function(b){4===b[0]?document.location.replace(b[1]):2===b[0]?(c.prop("disabled",!1).removeClass("field-loader"),alert(b[1])):1===b[0]?($(a).find(".data-field:first").focus(),$.each(b[1],function(b,c){b=d.clone();b.prepend('<th class="left-fixed-column">#</th>');b.find(".right-fixed-column").html("<tr>\n                                                                                    <th>Price</th>\n                                                                                    <th>More</th>\n                                                                                    <th>Del</th>\n                                                                                </tr>");
b=b.html();$("#window-curtain-calculation-quote-items-wrapper-"+f).show();var l=g.clone();l.prepend('<td class="left-fixed-column">\n                                                        <label class="checkbox-label" for="checkbox-'+c+'"></label>\n                                                        <input type="checkbox" id="checkbox-'+c+'" class="checkbox-input" name="quote-item-codes[]" value="'+c+'">\n                                                    </td>');l.find(".right-fixed-column").html('<tr>\n                                                                                <td><input type="tel" name="price" data-column="price" class="window-curtain-calculation-price price-input data-field ui-state-default" autocomplete="off"></td>\n                                                                                <td><input type="button" class="window-curtain-calculation-table-more-bttn bttn-input" value="\u2605"></td>\n                                                                                <td><input type="button" class="bttn-input delete-window-curtain-calculation-quote-item" value="\u2716"></td>\n                                                                            </tr>');
if(h){var n="",m="";$.each(JSON.parse(h),function(a,b){m+='<option data-code="'+b.code+'" value="'+b.code+"<->"+b.name+"<->"+b.price+'">'+b.name+" | "+b.price+"</option>"});n='<span class="window-curtain-calculation-accessories-wrapper">\n                                                    <select class="window-curtain-calculation-accessories">\n                                                        <option value="">Accessories</option>\n                                                        '+
m+'                                                    </select>\n                                                    <input type="tel" class="add-window-curtain-calculation-accessory-qty qty-input" placeholder="Qty">\n                                                    <input type="button" class="add-window-curtain-calculation-accessories bttn-input" value="\u271a">\n                                                </span>'}else n="";if(e){var r="",t="";$.each(JSON.parse(e),function(a,b){t+='<option data-code="'+
b.code+'" value="'+b.code+"<->"+b.name+"<->"+b.price+'">'+b.name+" | "+b.price+"</option>"});r='<span class="window-curtain-calculation-per-meters-wrapper">\n                                                    <select class="window-curtain-calculation-per-meters">\n                                                        <option value="">Per Meters</option>\n                                                        '+t+'                                                    </select>\n                                                    <input type="tel" class="add-window-curtain-calculation-per-meter-width qty-input" placeholder="Width">\n                                                    <input type="button" class="add-window-curtain-calculation-per-meters bttn-input" value="\u271a">\n                                                </span>'}else r=
"";if(k){var p="",q="";$.each(JSON.parse(k),function(a,b){q+='<option data-code="'+b.code+'" value="'+b.code+"<->"+b.name+"<->"+b.price+'">'+b.name+" | "+b.price+"</option>"});p='<span class="window-curtain-calculation-fitting-charges-wrapper">\n                                                        <select class="window-curtain-calculation-fitting-charges">\n                                                            <option value="">Fitting Charges</option>\n                                                            '+
q+'                                                        </select>\n                                                        <input type="button" class="add-window-curtain-calculation-fitting-charges bttn-input" value="\u271a">\n                                                    </span>'}else p="";$('<form id="calculation-form-'+c+'" class="update-window-curtain-calculation-quote-item-form" action="./" method="POST">\n                                <input type="hidden" name="cid" class="cid" value="'+
cid+'">\n                                <input type="hidden" name="window-curtain-calculation-code" class="window-curtain-calculation-code" value="'+f+'">\n                                <input type="hidden" name="window-curtain-calculation-quote-item-code" class="window-curtain-calculation-quote-item-code" value="'+c+'">\n                                <table class="window-curtain-calculation-table">\n                                    <thead class="thead">\n                                        <tr class="thead-tr">'+
b+"</tr>\n                                    </thead>\n                                    <tbody>\n                                        "+l.html()+'                                    </tbody>\n                                </table>\n                                <table id="calculation-table-more-'+c+'"  class="window-curtain-calculation-table-more">\n                                    <tr>\n                                        <td class="table-more-notes" colspan="3">\n                                            <textarea name="notes" data-column="notes" class="window-curtain-calculation-notes data-field" placeholder="Notes"></textarea>\n                                        </td>\n                                    </tr>\n                                    <tr>\n                                        <td class="table-more-accessories">\n                                            '+
n+'                                        </td>\n                                        <td class="table-more-per-meters">\n                                            '+r+'                                        </td>\n                                        <td class="table-more-fitting-charges">\n                                            '+p+"                                        </td>\n                                    </tr>\n                                </table>\n                            </form>").appendTo("#quote-items-body-"+
f).queue(function(){var b=$(this);$.each(a.serializeArray(),function(a,c){b.find("[name='"+c.name+"']").val(c.value)});b.find(".bttn-input, .checkbox-input").button();b.dequeue()}).clearQueue()}),l.find(".bulk-action-button-wrapper").html('<input type="button" class="bulk-action-button window-curtain-calculation-select-all-bttn" value="\u2714">\n                                                                            <input type="button" class="bulk-action-button window-curtain-calculation-bulk-delete-bttn" value="Delete">\n                                                                            <input type="button" class="bulk-action-button window-curtain-calculation-bulk-copy-bttn" value="Copy">\n                                                                            <a href="print/order-sheet-window-curtain-calculation-'+
f+"-"+cid+'" target="_blank" class="bulk-action-button print-bttn" style="width: 145px;">Print Order Sheet</a>\n                                                                            <a href="https://file-gen.blinq.com.au/clients/'+user_account+"/order-sheet-xlsx-window-curtain-calculation-"+f+"-"+cid+'" target="_blank" class="bulk-action-button print-bttn" style="width: 175px;">Print Order Sheet Xlsx</a>\n                                                                            <form class="group-discount-form" style="float: right; margin-right: -6px; font-size: 12px;">\n                                                                                <input type="tel" class="group-total price-input ui-state-default" autocomplete="off" style="float: left;" disabled value="">\n                                                                                <input type="tel" class="group-discount price-input ui-state-default" autocomplete="off" placeholder="%" value="'+
n+'" style="float: left; margin-left: 1px !important; margin-right: 1px !important; text-align: center; width: 33px;" required value="">\n                                                                                <input type="hidden" class="window-curtain-calculation-code" value="'+f+'">\n                                                                                <input type="submit" class="bttn-input ui-button ui-widget ui-state-default ui-corner-all" value="\u2714" role="button" aria-disabled="false" style="float: left;">\n                                                                            </form>\n                                                                            <div class="group-discount-total" style="float: right; line-height: 40px; margin-right: 400px; font-size: 22px; font-weight: bold;"></div>\n                                                                            ').find(".bulk-action-button").button(),
l.find(".checkbox-label").each(function(b){$(this).find(".ui-button-text").html(b+1)}),a[0].reset(),c.prop("disabled",!1).removeClass("field-loader"),p(l.find(".group-discount-form"))):(c.prop("disabled",!1).removeClass("field-loader"),alert(JSON.stringify(b)))},error:function(b,a,d){c.prop("disabled",!1).removeClass("field-loader");alert(JSON.stringify(b));alert("Error! @add-window-curtain-calculation-quote-item")}})});$(document).on("change",".update-window-curtain-calculation-quote-item-form .data-field",
function(b){b.preventDefault();var a=$(this),c=a.attr("name"),d=a.val();if("add-new"===d)return!1;var g=a.parents(".update-window-curtain-calculation-quote-item-form"),f=g.find(".checkbox-input"),h=g.parents(".window-curtain-calculation-quote-items-body").find(".checkbox-input:checked"),e="";f.is(":checked")&&h.length?(e=[],h.each(function(){var b=$(this).parents(".update-window-curtain-calculation-quote-item-form"),a=b.find("[name='"+c+"']"),h=a.val();"fabric"===a.attr("name")?a.val(h):a.val(d);
q(a);("width"===a.attr("name")||"right_return"===a.attr("name")||"left_return"===a.attr("name")||"overlap"===a.attr("name")||"fullness"===a.attr("name")||"supplier"===a.attr("name")||"fabric"===a.attr("name")||"curtain_type_1"===a.attr("name")||"curtain_type_2"===a.attr("name")||"drop"===a.attr("name")||"hem_heading"===a.attr("name")||"pattern_repeate"===a.attr("name")||a.hasClass("window-curtain-calculation-field"))&&w(a);e.push(b.serialize())})):(q(a),("width"===a.attr("name")||"right_return"===
a.attr("name")||"left_return"===a.attr("name")||"overlap"===a.attr("name")||"fullness"===a.attr("name")||"supplier"===a.attr("name")||"fabric"===a.attr("name")||"curtain_type_1"===a.attr("name")||"curtain_type_2"===a.attr("name")||"drop"===a.attr("name")||"hem_heading"===a.attr("name")||"pattern_repeate"===a.attr("name")||a.hasClass("window-curtain-calculation-field"))&&w(a),e=[g.serialize()]);$.ajax({url:"window-curtain-calculation/scripts/update-window-curtain-calculation-quote-item.php",type:"POST",
dataType:"json",data:{quote_items_array:e},beforeSend:function(){a.toggleClass("field-loader")},success:function(b){if(4===b[0])document.location.replace(b[1]);else if(2===b[0])a.toggleClass("field-loader"),alert(b[1]);else if(1===b[0]){if(f.is(":checked")&&h.length)h.each(function(){var a=$(this).parents(".update-window-curtain-calculation-quote-item-form"),b=a.find(".window-curtain-calculation-notes").val().length,c=a.find(".window-curtain-calculation-accessory").length,d=a.find(".window-curtain-calculation-per-meter").length,
e=a.find(".window-curtain-calculation-fitting-charge").length;b||c||d||e?a.find(".window-curtain-calculation-table-more-bttn").addClass("red"):a.find(".window-curtain-calculation-table-more-bttn").removeClass("red")});else{b=g.find(".window-curtain-calculation-notes").val().length;var c=g.find(".window-curtain-calculation-accessory").length,d=g.find(".window-curtain-calculation-per-meter").length,e=g.find(".window-curtain-calculation-fitting-charge").length;b||c||d||e?g.find(".window-curtain-calculation-table-more-bttn").addClass("red"):
g.find(".window-curtain-calculation-table-more-bttn").removeClass("red")}a.toggleClass("field-loader");p(g)}else a.toggleClass("field-loader"),alert(JSON.stringify(b))},error:function(b,c,d){a.toggleClass("field-loader");alert(JSON.stringify(b));alert("Error! @update-window-curtain-calculation-quote-item")}})});$(document).on("keypress",".add-window-curtain-calculation-accessory-qty",function(b){13===b.keyCode&&(b.preventDefault(),$(this).siblings(".add-window-curtain-calculation-accessories").click())});
$(document).on("click",".add-window-curtain-calculation-accessories",function(){var b=$(this),a=b.parents(".update-window-curtain-calculation-quote-item-form"),c=b.siblings(".window-curtain-calculation-accessories"),d=b.siblings(".add-window-curtain-calculation-accessory-qty"),g=a.find(".window-curtain-calculation-code").val(),f=a.find(".window-curtain-calculation-quote-item-code").val(),h=c.val(),e=+d.val();e=0!==e?e:1;h&&$.ajax({url:"window-curtain-calculation/scripts/add-window-curtain-calculation-quote-item-accessory.php",
type:"POST",dataType:"json",data:{cid,window_curtain_calculation_code:g,window_curtain_calculation_quote_item_code:f,accessory:h,accessory_qty:e},beforeSend:function(){b.prop("disabled",!1).addClass("field-loader");c.addClass("field-loader");d.addClass("field-loader")},success:function(k){if(4===k[0])document.location.replace(k[1]);else if(2===k[0])b.prop("disabled",!1).removeClass("field-loader"),c.removeClass("field-loader"),d.removeClass("field-loader"),alert(k[1]);else if(1===k[0]){k=h.split("<->")[0];
var f=h.split("<->")[1],g=+h.split("<->")[2].replace(/,/g,""),m=(g*e).toFixed(2);a.find(".table-more-accessories").append('<span class="window-curtain-calculation-accessories-wrapper">\n                                                                                <input type="text" class="window-curtain-calculation-accessory" readonly disabled value="'+f+" | "+g+" x "+e+" = "+m+'">\n                                                                                <input type="button" class="delete-window-curtain-calculation-accessory bttn-input" data-code="'+
k+'" value="\u2716">\n                                                                            </span>').find(".bttn-input").button();c.find('option[data-code="'+k+'"]').hide();c.val("").focus();d.val("");k=a.find(".window-curtain-calculation-notes").val().length;f=a.find(".window-curtain-calculation-accessory").length;g=a.find(".window-curtain-calculation-per-meter").length;m=a.find(".window-curtain-calculation-fitting-charge").length;k||f||g||m?a.find(".window-curtain-calculation-table-more-bttn").addClass("red"):
a.find(".window-curtain-calculation-table-more-bttn").removeClass("red");b.prop("disabled",!1).removeClass("field-loader");c.removeClass("field-loader");d.removeClass("field-loader");$("#getsum").load("getsum.php?cid="+cid).fadeIn("fast");$("#totalx").load("megaTotal.php?cid="+cid).fadeIn("fast")}else b.prop("disabled",!1).removeClass("field-loader"),c.removeClass("field-loader"),d.removeClass("field-loader"),alert(JSON.stringify(k))},error:function(a,e,h){b.prop("disabled",!1).removeClass("field-loader");
c.removeClass("field-loader");d.removeClass("field-loader");alert(JSON.stringify(a));alert("Error! @add-window-curtain-calculation-quote-item-accessory")}})});$(document).on("click",".delete-window-curtain-calculation-accessory",function(){var b=$(this),a=b.parents(".update-window-curtain-calculation-quote-item-form"),c=a.find(".window-curtain-calculation-accessories"),d=b.parent(".window-curtain-calculation-accessories-wrapper"),g=a.find(".window-curtain-calculation-code").val(),f=a.find(".window-curtain-calculation-quote-item-code").val(),
h=b.attr("data-code");$.ajax({url:"window-curtain-calculation/scripts/delete-window-curtain-calculation-quote-item-accessory.php",type:"POST",dataType:"json",data:{cid,window_curtain_calculation_code:g,window_curtain_calculation_quote_item_code:f,accessory_code:h},beforeSend:function(){b.prop("disabled",!1).addClass("field-loader")},success:function(e){if(4===e[0])document.location.replace(e[1]);else if(2===e[0])b.prop("disabled",!1).removeClass("field-loader"),alert(e[1]);else if(1===e[0]){d.remove();
c.find('option[data-code="'+h+'"]').show();c.val("");e=a.find(".window-curtain-calculation-notes").val().length;var f=a.find(".window-curtain-calculation-accessory").length,g=a.find(".window-curtain-calculation-fitting-charge").length;e||f||g?a.find(".window-curtain-calculation-table-more-bttn").addClass("red"):a.find(".window-curtain-calculation-table-more-bttn").removeClass("red");b.prop("disabled",!1).removeClass("field-loader");$("#getsum").load("getsum.php?cid="+cid).fadeIn("fast");$("#totalx").load("megaTotal.php?cid="+
cid).fadeIn("fast")}else b.prop("disabled",!1).removeClass("field-loader"),alert(JSON.stringify(e))},error:function(a,c,d){b.prop("disabled",!1).removeClass("field-loader");alert(JSON.stringify(a));alert("Error! @delete-window-curtain-calculation-quote-item-accessory")}})});$(document).on("keypress",".add-window-curtain-calculation-per-meter-width",function(b){13===b.keyCode&&(b.preventDefault(),$(this).siblings(".add-window-curtain-calculation-per-meters").click())});$(document).on("click",".add-window-curtain-calculation-per-meters",
function(){var b=$(this),a=b.parents(".update-window-curtain-calculation-quote-item-form"),c=b.siblings(".window-curtain-calculation-per-meters"),d=b.siblings(".add-window-curtain-calculation-per-meter-width"),g=a.find(".window-curtain-calculation-code").val(),f=a.find(".window-curtain-calculation-quote-item-code").val(),h=c.val(),e=+d.val();e=0!==e?e:1;h&&$.ajax({url:"window-curtain-calculation/scripts/add-window-curtain-calculation-quote-item-per-meter.php",type:"POST",dataType:"json",data:{cid,
window_curtain_calculation_code:g,window_curtain_calculation_quote_item_code:f,per_meter:h,per_meter_width:e},beforeSend:function(){b.prop("disabled",!1).addClass("field-loader");c.addClass("field-loader");d.addClass("field-loader")},success:function(f){if(4===f[0])document.location.replace(f[1]);else if(2===f[0])b.prop("disabled",!1).removeClass("field-loader"),c.removeClass("field-loader"),d.removeClass("field-loader"),alert(f[1]);else if(1===f[0]){f=h.split("<->")[0];var g=h.split("<->")[1],k=
+h.split("<->")[2].replace(/,/g,""),m=(k*e).toFixed(2);a.find(".table-more-per-meters").append('<span class="window-curtain-calculation-per-meters-wrapper">\n                                                                                <input type="text" class="window-curtain-calculation-per-meter" readonly disabled value="'+g+" | "+k+" x "+e+" = "+m+'">\n                                                                                <input type="button" class="delete-window-curtain-calculation-per-meter bttn-input" data-code="'+
f+'" value="\u2716">\n                                                                            </span>').find(".bttn-input").button();c.find('option[data-code="'+f+'"]').hide();c.val("").focus();d.val("");f=a.find(".window-curtain-calculation-notes").val().length;g=a.find(".window-curtain-calculation-accessory").length;k=a.find(".window-curtain-calculation-per-meter").length;m=a.find(".window-curtain-calculation-fitting-charge").length;f||g||k||m?a.find(".window-curtain-calculation-table-more-bttn").addClass("red"):
a.find(".window-curtain-calculation-table-more-bttn").removeClass("red");b.prop("disabled",!1).removeClass("field-loader");c.removeClass("field-loader");d.removeClass("field-loader");$("#getsum").load("getsum.php?cid="+cid).fadeIn("fast");$("#totalx").load("megaTotal.php?cid="+cid).fadeIn("fast")}else b.prop("disabled",!1).removeClass("field-loader"),c.removeClass("field-loader"),d.removeClass("field-loader"),alert(JSON.stringify(f))},error:function(a,e,h){b.prop("disabled",!1).removeClass("field-loader");
c.removeClass("field-loader");d.removeClass("field-loader");alert(JSON.stringify(a));alert("Error! @add-window-curtain-calculation-quote-item-per-meter")}})});$(document).on("click",".delete-window-curtain-calculation-per-meter",function(){var b=$(this),a=b.parents(".update-window-curtain-calculation-quote-item-form"),c=a.find(".window-curtain-calculation-per-meters"),d=b.parent(".window-curtain-calculation-per-meters-wrapper"),g=a.find(".window-curtain-calculation-code").val(),f=a.find(".window-curtain-calculation-quote-item-code").val(),
h=b.attr("data-code");$.ajax({url:"window-curtain-calculation/scripts/delete-window-curtain-calculation-quote-item-per-meter.php",type:"POST",dataType:"json",data:{cid,window_curtain_calculation_code:g,window_curtain_calculation_quote_item_code:f,per_meter_code:h},beforeSend:function(){b.prop("disabled",!1).addClass("field-loader")},success:function(e){if(4===e[0])document.location.replace(e[1]);else if(2===e[0])b.prop("disabled",!1).removeClass("field-loader"),alert(e[1]);else if(1===e[0]){d.remove();
c.find('option[data-code="'+h+'"]').show();c.val("");e=a.find(".window-curtain-calculation-notes").val().length;var f=a.find(".window-curtain-calculation-accessory").length,g=a.find(".window-curtain-calculation-per-meter").length,n=a.find(".window-curtain-calculation-fitting-charge").length;e||f||g||n?a.find(".window-curtain-calculation-table-more-bttn").addClass("red"):a.find(".window-curtain-calculation-table-more-bttn").removeClass("red");b.prop("disabled",!1).removeClass("field-loader");$("#getsum").load("getsum.php?cid="+
cid).fadeIn("fast");$("#totalx").load("megaTotal.php?cid="+cid).fadeIn("fast")}else b.prop("disabled",!1).removeClass("field-loader"),alert(JSON.stringify(e))},error:function(a,c,d){b.prop("disabled",!1).removeClass("field-loader");alert(JSON.stringify(a));alert("Error! @delete-window-curtain-calculation-quote-item-per-meter")}})});$(document).on("click",".add-window-curtain-calculation-fitting-charges",function(){var b=$(this),a=b.parents(".update-window-curtain-calculation-quote-item-form"),c=b.siblings(".window-curtain-calculation-fitting-charges"),
d=a.find(".window-curtain-calculation-code").val(),g=a.find(".window-curtain-calculation-quote-item-code").val(),f=c.val();f&&$.ajax({url:"window-curtain-calculation/scripts/add-window-curtain-calculation-quote-item-fitting-charge.php",type:"POST",dataType:"json",data:{cid,window_curtain_calculation_code:d,window_curtain_calculation_quote_item_code:g,fitting_charge:f},beforeSend:function(){b.prop("disabled",!1).addClass("field-loader");c.toggleClass("field-loader")},success:function(d){if(4===d[0])document.location.replace(d[1]);
else if(2===d[0])b.prop("disabled",!1).removeClass("field-loader"),c.toggleClass("field-loader"),alert(d[1]);else if(1===d[0]){d=f.split("<->")[0];var e=f.split("<->")[1],h=f.split("<->")[2];a.find(".table-more-fitting-charges").append('<span class="window-curtain-calculation-fitting-charges-wrapper">\n                                                                                    <input type="text" class="window-curtain-calculation-fitting-charge" readonly disabled value="'+e+" | "+h+'">\n                                                                                    <input type="button" class="delete-window-curtain-calculation-fitting-charge bttn-input" data-code="'+
d+'" value="\u2716">\n                                                                                </span>').find(".bttn-input").button();c.val("");d=a.find(".window-curtain-calculation-notes").val().length;e=a.find(".window-curtain-calculation-accessory").length;h=a.find(".window-curtain-calculation-fitting-charge").length;d||e||h?a.find(".window-curtain-calculation-table-more-bttn").addClass("red"):a.find(".window-curtain-calculation-table-more-bttn").removeClass("red");b.prop("disabled",!1).removeClass("field-loader");
c.toggleClass("field-loader");$("#getsum").load("getsum.php?cid="+cid).fadeIn("fast");$("#totalx").load("megaTotal.php?cid="+cid).fadeIn("fast")}else b.prop("disabled",!1).removeClass("field-loader"),c.toggleClass("field-loader"),alert(JSON.stringify(d))},error:function(a,d,f){b.prop("disabled",!1).removeClass("field-loader");c.toggleClass("field-loader");alert(JSON.stringify(a));alert("Error! @add-window-curtain-calculation-quote-item-fitting-charge")}})});$(document).on("click",".delete-window-curtain-calculation-fitting-charge",
function(){var b=$(this),a=b.parents(".update-window-curtain-calculation-quote-item-form"),c=a.find(".window-curtain-calculation-fitting-charges"),d=b.parent(".window-curtain-calculation-fitting-charges-wrapper"),g=a.find(".window-curtain-calculation-code").val(),f=a.find(".window-curtain-calculation-quote-item-code").val(),h=b.attr("data-code");$.ajax({url:"window-curtain-calculation/scripts/delete-window-curtain-calculation-quote-item-fitting-charge.php",type:"POST",dataType:"json",data:{cid,window_curtain_calculation_code:g,
window_curtain_calculation_quote_item_code:f,fitting_charge_code:h},beforeSend:function(){b.prop("disabled",!1).addClass("field-loader")},success:function(e){if(4===e[0])document.location.replace(e[1]);else if(2===e[0])b.prop("disabled",!1).removeClass("field-loader"),alert(e[1]);else if(1===e[0]){d.remove();c.find('option[data-code="'+h+'"]').show();c.val("");e=a.find(".window-curtain-calculation-notes").val().length;var f=a.find(".window-curtain-calculation-accessory").length,g=a.find(".window-curtain-calculation-fitting-charge").length;
e||f||g?a.find(".window-curtain-calculation-table-more-bttn").addClass("red"):a.find(".window-curtain-calculation-table-more-bttn").removeClass("red");b.prop("disabled",!1).removeClass("field-loader");$("#getsum").load("getsum.php?cid="+cid).fadeIn("fast");$("#totalx").load("megaTotal.php?cid="+cid).fadeIn("fast")}else b.prop("disabled",!1).removeClass("field-loader"),alert(JSON.stringify(e))},error:function(a,c,d){b.prop("disabled",!1).removeClass("field-loader");alert(JSON.stringify(a));alert("Error! @delete-window-curtain-calculation-quote-item-fitting-charge")}})});
$(document).on("submit","#window-curtain-calculation-quote-items-results .group-discount-form",function(b){b.preventDefault();var a=$(this),c=$(this).find("input[type='submit']");b=isNaN(a.find(".group-discount").val())?"0":a.find(".group-discount").val();var d=isNaN(a.find(".group-total").val())?"0":a.find(".group-total").val(),g=a.find(".window-curtain-calculation-code").val(),f=(d-d*b/100).toFixed(2);$.ajax({url:"window-curtain-calculation/scripts/update-window-curtain-calculation-group-discount.php",
type:"POST",dataType:"json",data:{cid,discount:b,window_curtain_calculation_code:g},beforeSend:function(){c.prop("disabled",!1).addClass("field-loader")},success:function(b){4===b[0]?document.location.replace(b[1]):2===b[0]?(c.prop("disabled",!1).removeClass("field-loader"),alert(b[1])):1===b[0]?(a.siblings(".group-discount-total").html(f),c.prop("disabled",!1).removeClass("field-loader")):(c.prop("disabled",!1).removeClass("field-loader"),alert(JSON.stringify(b)));$("#getsum").load("getsum.php?cid="+
cid).fadeIn("fast");$("#totalx").load("megaTotal.php?cid="+cid).fadeIn("fast")},error:function(a,b,d){c.prop("disabled",!1).removeClass("field-loader");alert(JSON.stringify(a));alert("Error! @update-window-curtain-calculation-group-discount")}})})});