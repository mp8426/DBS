function get_form_no_1_calculation_price(e){var t=$(e).parents("form"),a=t.find(".form-no-1-calculation-price"),o=t.find(".form-no-1-calculation-field"),n=t.find(".form-no-1-calculation-qty"),l=t.find(".form-no-1-calculation-total"),i=t.find('input[name="qty_field"]').val(),c=t.find(".form-no-1-calculation-code").val(),r=t.find(".form-no-1-calculation-cost").length?+t.find(".form-no-1-calculation-cost").val():0,d=t.find(".form-no-1-calculation-markup").length?+t.find(".form-no-1-calculation-markup").val():1,s=0;if($.each(o,function(){var e=$(this).val().split("<->")[2];if(s+=e>0?+e:0,$(this).hasClass("have-sub-options")&&$(this).attr("data-selected-sub-options")){var t=JSON.parse($(this).attr("data-selected-sub-options"));s+=get_sub_option_price_total(t,0)}}),""!==c&&""!==r&&""!==d&&(s+=r+r*d/100),a.val(s.toFixed(2)),"on"===i){var u=(s*n.val()).toFixed(2);l.val(u)}else{u=s.toFixed(2);l.val(u)}}function update_form_no_1_calculation_total_price(e){var t=e.find(".form-no-1-calculation-price"),a=e.find(".form-no-1-calculation-qty"),o=e.find(".form-no-1-calculation-total"),n=e.find('input[name="qty_field"]').val(),l=+t.val(),i=l.toFixed(2);if(t.val(i),"on"===n){var c=(l*a.val()).toFixed(2);o.val(c)}else{c=l.toFixed(2);o.val(c)}}function form_no_1_calculation_add_field_option(e,t,a){a=$(a);var o=a.parents("form"),n=a.parents(".form-no-1-calculation-add-field-option-wrapper"),l=n.find(".form-no-1-calculation-add-field-option"),i=n.find(".form-no-1-calculation-add-field-option-submit"),c=n.siblings(".form-no-1-calculation-field"),r=c.attr("data-code"),d=o.find(".form-no-1-calculation-code").val(),s=o.find(".data-field, .number-input, select, [type='submit']"),u=c.siblings(".comboTree-btn");e=e,t=""!==t?Number(t):0;e&&$.ajax({url:"form-no-1-calculation/scripts/add-form-no-1-calculation-field-option.php",type:"POST",dataType:"json",data:{field_code:r,field_option_name:e,field_option_price:t,form_no_1_calculation_code:d},beforeSend:function(){l.prop("disabled",!0).addClass("field-loader"),i.prop("disabled",!0).addClass("field-loader")},success:function(e){if(4===e[0])document.location.replace(e[1]);else if(2===e[0])alert(e[1]);else if(1===e[0]){var t=Number(e[3]).toFixed(2);$(".form-no-1-calculation-add-field-option-x[data-field-code="+r+"]").before('<option value="'+e[2]+"<->"+e[1]+"<->"+t+'">'+e[2]+" | "+t+"</option>");var a=o.find(".checkbox-input"),d=o.parents(".form-no-1-calculation-quote-items-body").find(".checkbox-input:checked");a.is(":checked")&&d.length&&d.not(a).each(function(){var e=$(this).parents(".update-form-no-1-calculation-quote-item-form"),t=e.find(".data-field, .number-input, select, [type='submit']");t.prop("disabled",!1)}),l.val(""),n.hide(),s.prop("disabled",!1),u.show(),c.show().val(e[2]+"<->"+e[1]+"<->"+t).change()}else alert(e);l.prop("disabled",!1).removeClass("field-loader"),i.prop("disabled",!1).removeClass("field-loader")},error:function(e,t,a){l.prop("disabled",!1).removeClass("field-loader"),i.prop("disabled",!1).removeClass("field-loader")}})}function form_no_1_calculation_group_discount(e){var t=$(e).parents(".form-no-1-calculation-quote-items-wrapper"),a=t.find(".form-no-1-calculation-quote-items-body"),o=a.find(".right-fixed-column:visible input[name='total']"),n=$.isNumeric(+t.find(".group-discount").val())?+t.find(".group-discount").val():0,l=0;o.each(function(){l+=Number($(this).val().replace(/,/g,""))});var i=l-l*n/100;t.find(".group-total").val(l.toFixed(2)).end().find(".group-discount").val(n).end().find(".group-discount-total").html(currency(i)).end().find(".group-discount-form").submit()}function update_form_no_1_calculation_quote_item(e,t){var a=$(e),o=a.val();if("add-new"===o)return!1;var n=a.parents(".update-form-no-1-calculation-quote-item-form"),l=n.find(".checkbox-input"),i=n.parents(".form-no-1-calculation-quote-items-body").find(".checkbox-input:checked");$.ajax({url:"form-no-1-calculation/scripts/update-form-no-1-calculation-quote-item.php",type:"POST",dataType:"json",data:{quote_items_array:t},beforeSend:function(){},success:function(e){if(4===e[0])document.location.replace(e[1]);else if(2===e[0])a.removeClass("field-loader"),alert(e[1]);else if(1===e[0]){if(l.is(":checked")&&i.length)i.each(function(){var e=$(this).parents(".update-form-no-1-calculation-quote-item-form"),t=e.find(".form-no-1-calculation-notes").val().length,a=e.find(".form-no-1-calculation-accessory").length,o=e.find(".form-no-1-calculation-per-meter").length,n=e.find(".form-no-1-calculation-fitting-charge").length;t||a||o||n?e.find(".form-no-1-calculation-table-more-bttn").addClass("red"):e.find(".form-no-1-calculation-table-more-bttn").removeClass("red")});else{var t=n.find(".form-no-1-calculation-notes").val().length,o=n.find(".form-no-1-calculation-accessory").length,c=n.find(".form-no-1-calculation-per-meter").length,r=n.find(".form-no-1-calculation-fitting-charge").length;t||o||c||r?n.find(".form-no-1-calculation-table-more-bttn").addClass("red"):n.find(".form-no-1-calculation-table-more-bttn").removeClass("red")}a.removeClass("field-loader"),form_no_1_calculation_group_discount(n)}else a.removeClass("field-loader"),alert(JSON.stringify(e))},error:function(e,t,o){a.removeClass("field-loader"),alert(JSON.stringify(e)),alert("Error! @update-form-no-1-calculation-quote-item")}})}$(function(){$.ajax({url:"form-no-1-calculation/scripts/get-form-no-1-calculations.php",type:"POST",dataType:"json",data:{cid:cid},beforeSend:function(){},success:function(e){4===e[0]?document.location.replace(e[1]):2===e[0]?alert(e[1]):1===e[0]?($.each(e[1],function(t,a){var o=a.code;if(1===a.location_select){var n="<th>Locations</th>",l="";$.each(e[2],function(e,t){l+='<option value="'+t.name+"<->"+t.code+'">'+t.name+"</option>"});var i='<td>\n                                                    <select name="location" data-column="location" class="form-no-1-calculation-location data-field">\n                                                        <option value=""></option>\n                                                        '+l+"                                                    </select>\n                                                </td>"}else n="",l="",i="";if(1===a.cost_select)var c="<th>Cost</th>",r='<td>\n                                                <input type="tel" name="cost" data-column="cost" class="form-no-1-calculation-cost number-input data-field" maxlength="4" autocomplete="off" min="0" placeholder="">\n                                            </td>';else c="",r="";if(1===a.markup_select)var d="<th>Markup</th>",s='<td>\n                                                <input type="tel" name="markup" data-column="markup" class="form-no-1-calculation-markup number-input data-field" maxlength="4" autocomplete="off" min="0" placeholder="%">\n                                            </td>';else d="",s="";var u="",f="",p="",m="";if($.each(a.fields,function(e,t){if(1===t.side)if(u+="<th>"+t.name+"</th>",0===t.field_type){var a="",o="",n=0,l="";$.each(t.options,function(e,t){var a=t.price>0?" | "+t.price:"";l+='<option value="'+t.name+"<->"+t.code+"<->"+t.price+'" data-price-type="'+t.price_type+"\" data-sub-options='"+t.sub_options+"'>"+t.name+a+"</option>";var o=JSON.parse(t.sub_options);n+=""!==o&&null!=o?Number(Object.keys(o).length):0}),l+='<option class="form-no-1-calculation-add-field-option-x" data-field-code="'+t.code+'" value="add-new">Add New</option>',n&&(o="have-sub-options",a='<button type="button" class="comboTree-btn">☳</button>'),f+='<td>\n                                                        <select name="field['+t.code+']" data-code="'+t.code+'" data-column="field-'+t.code+'" class="form-no-1-calculation-field data-field '+o+'">\n                                                            <option value=""></option>\n                                                            '+l+"                                                        </select>\n                                                        "+a+'                                                        <span class="form-no-1-calculation-add-field-option-wrapper">\n                                                            <input type="text" class="form-no-1-calculation-add-field-option text-input" placeholder="Option Name">\n                                                            <input type="number" steps="0.01"  class="form-no-1-calculation-add-field-option-price text-input" placeholder="Price">\n                                                            <input type="button" class="form-no-1-calculation-add-field-option-submit bttn-input" value="✚">\n                                                            <input type="button" class="form-no-1-calculation-add-field-option-close bttn-input" value="✖">\n                                                        </span>\n                                                    </td>'}else f+='<td>\n                                                        <input type="text" name="field['+t.code+']" data-code="'+t.code+'" data-column="field-'+t.code+'" class="form-no-1-calculation-field data-field text-field" autocomplete="off">\n                                                    </td>';if(0===t.side)if(p+="<th>"+t.name+"</th>",0===t.field_type){a="",o="",n=0,l="";$.each(t.options,function(e,t){var a=t.price>0?" | "+t.price:"";l+='<option value="'+t.name+"<->"+t.code+"<->"+t.price+'" data-price-type="'+t.price_type+"\" data-sub-options='"+t.sub_options+"'>"+t.name+a+"</option>";var o=JSON.parse(t.sub_options);n+=""!==o&&null!=o?Number(Object.keys(o).length):0}),l+='<option class="form-no-1-calculation-add-field-option-x" data-field-code="'+t.code+'" value="add-new">Add New</option>',n&&(o="have-sub-options",a='<button type="button" class="comboTree-btn">☳</button>'),m+='<td>\n                                                            <select name="field['+t.code+']" data-code="'+t.code+'" data-column="field-'+t.code+'" class="form-no-1-calculation-field data-field '+o+'">\n                                                                <option value=""></option>\n                                                                '+l+"                                                            </select>\n                                                            "+a+'                                                            <span class="form-no-1-calculation-add-field-option-wrapper">\n                                                                <input type="text" class="form-no-1-calculation-add-field-option text-input" placeholder="Option Name">\n                                                                <input type="number" steps="0.01" class="form-no-1-calculation-add-field-option-price text-input" placeholder="Price">\n                                                                <input type="button" class="form-no-1-calculation-add-field-option-submit bttn-input" value="✚">\n                                                                <input type="button" class="form-no-1-calculation-add-field-option-close bttn-input" value="✖">\n                                                            </span>\n                                                        </td>'}else m+='<td>\n                                                            <input type="text" name="field['+t.code+']" data-code="'+t.code+'" data-column="field-'+t.code+'" class="form-no-1-calculation-field data-field text-field" autocomplete="off">\n                                                        </td>'}),1===a.accessories_select){var b="",h="",v='<input type="hidden" class="accessory-option-array" value=\''+JSON.stringify(a.accessory_options)+"'>";$.each(a.accessory_options,function(e,t){h+='<option data-code="'+t.code+'" value="'+t.code+"<->"+t.name+"<->"+t.price+'">'+t.name+" | "+t.price+"</option>"}),b='<span class="form-no-1-calculation-accessories-wrapper">\n                                                <select class="form-no-1-calculation-accessories">\n                                                    <option value="">Accessories</option>\n                                                    '+h+'                                                </select>\n                                                <input type="tel" class="add-form-no-1-calculation-accessory-qty qty-input" placeholder="Qty">\n                                                <input type="button" class="add-form-no-1-calculation-accessories bttn-input" value="✚">\n                                            </span>'}else b="",v="";if(1===a.per_meters_select){var g="",y="",_='<input type="hidden" class="per-meter-option-array" value=\''+JSON.stringify(a.per_meter_options)+"'>";$.each(a.per_meter_options,function(e,t){y+='<option data-code="'+t.code+'" value="'+t.code+"<->"+t.name+"<->"+t.price+'">'+t.name+" | "+t.price+"</option>"}),g='<span class="form-no-1-calculation-accessories-wrapper">\n                                                <select class="form-no-1-calculation-per-meters">\n                                                    <option value="">Per Meters</option>\n                                                    '+y+'                                                </select>\n                                                <input type="tel" class="add-form-no-1-calculation-per-meter-width qty-input" placeholder="Width">\n                                                <input type="button" class="add-form-no-1-calculation-per-meters bttn-input" value="✚">\n                                            </span>'}else g="",_="";if(1===a.fitting_charges_select){var q="",C="",x='<input type="hidden" class="fitting-charge-option-array" value=\''+JSON.stringify(a.fitting_charge_options)+"'>";$.each(a.fitting_charge_options,function(e,t){C+='<option data-code="'+t.code+'" value="'+t.code+"<->"+t.name+"<->"+t.price+'">'+t.name+" | "+t.price+"</option>"}),q='<span class="form-no-1-calculation-fitting-charges-wrapper">\n                                                    <select class="form-no-1-calculation-fitting-charges">\n                                                        <option value="">Fitting Charges</option>\n                                                        '+C+'                                                    </select>\n                                                    <input type="button" class="add-form-no-1-calculation-fitting-charges bttn-input" value="✚">\n                                                </span>'}else q="",x="";if(1===a.qty_select)var k="qty_on",S="<th>Price</th><th>Qty</th><th>Total</th>",w='<td><input type="tel" name="price" class="form-no-1-calculation-price price-input data-field" autocomplete="off"></td><td><input type="number" name="qty" class="form-no-1-calculation-qty number-input" autocomplete="off" min="1" value="1"></td><td><input type="number" name="total" class="form-no-1-calculation-total number-input" autocomplete="off" min="1" value="" readonly><input type="hidden" class="data-field" name="qty_field" value="on"></td>',O="<th>Price</th><th>Qty</th><th>Total</th>",T='<td><input type="tel" name="price" class="form-no-1-calculation-price price-input data-field" autocomplete="off"></td><td><input type="number" name="qty" class="form-no-1-calculation-qty number-input data-field" autocomplete="off" min="1" value="1"></td><td><input type="number" name="total" class="form-no-1-calculation-total number-input ui-state-default" autocomplete="off" min="1" value="" readonly><input type="hidden" class="data-field" name="qty_field" value="on"></td>';else k="",S="<th>Price</th><th>Qty</th>",w='<td><input type="tel" name="price" class="form-no-1-calculation-price price-input data-field" style="width: calc(100% - 12px);" autocomplete="off"></td><td><input type="number" name="qty" class="form-no-1-calculation-qty number-input" autocomplete="off" min="1" value="1" style="min-width: 0;"><input type="hidden" name="total" class="form-no-1-calculation-total number-input" autocomplete="off" min="1" value=""><input type="hidden" class="data-field" name="qty_field" value="off"></td>',O="<th>Price</th>",T='<td><input type="tel" name="price" data-column="price" class="form-no-1-calculation-price price-input data-field ui-state-default" autocomplete="off" value=""><input type="hidden" name="qty" class="form-no-1-calculation-qty number-input data-field" autocomplete="off" min="1" value="1"><input type="hidden" name="total" data-column="total" class="form-no-1-calculation-total price-input data-field" autocomplete="off" value="0" readonly><input type="hidden" class="data-field" name="qty_field" value="off"></td>';if(1===a.status&&($('<li><a href="#tab-'+a.code+'">'+a.name+"</a></li>").prependTo("#form-no-1-calculation-tabs .tabs ul"),$('<div id="tab-'+a.code+'" class="form-no-1-calculation-tab-div"></div>').append($('<form class="add-form-no-1-calculation-quote-item-form '+k+'" action="./" method="POST"></form>').append('<input type="hidden" name="calc-name" class="calc-name" value="form_no_1">').append('<input type="hidden" class="cid" name="cid" value="'+cid+'">').append('<input type="hidden" class="form-no-1-calculation-code" name="form-no-1-calculation-code" value="'+o+'">').append($('<table class="form-no-1-calculation-table"></table>').append($('<thead class="thead"></thead>').append($('<tr class="thead-tr"></tr>').append(u).append(n).append(p).append(c).append(d).append('<th>\n                                                        <table class="right-fixed-column">\n                                                            <tr>\n                                                            '+S+"<th>Add</th>\n                                                            </tr>\n                                                        </table>\n                                                    </th>"))).append($("<tbody></tbody>").append($('<tr class="tbody-tr"></tr>').append(f).append(i).append(m).append(r).append(s).append('<td>\n                                                        <table class="right-fixed-column" style="margin-top: -20px;">\n                                                            <tr>\n                                                            '+w+'<td><button type="submit" class="bttn-input"><i class="fa fa-plus" aria-hidden="true"></i></button></td>\n                                                            </tr>\n                                                        </table>\n                                                    </td>')))).append(v).append(_).append(x)).prependTo("#form-no-1-calculation-tabs .calculation-results").find(".bttn-input").button()),"[]"!==JSON.stringify(a.quote_items)){$('<div id="form-no-1-calculation-quote-items-wrapper-'+o+'" class="form-no-1-calculation-quote-items-wrapper"></div>').append('<h2 class="form-no-1-calculation-header">'+a.name+"</h2>").append('<div id="quote-items-body-'+o+'" class="form-no-1-calculation-quote-items-body '+k+'"></div>').append('<div class="bulk-action-button-wrapper">\n                                    <button class="fa-btn quote-item-select-all-bttn tltip" data-title="Select All"><i class="fa fa-square" aria-hidden="true"></i></button>\n                                    <button class="fa-btn quote-item-sort-bttn tltip" data-title="Sort Selection"><i class="fa fa-sort" aria-hidden="true"></i></button>\n                                    <button class="fa-btn form-no-1-calculation-bulk-copy-bttn tltip" data-title="Copy Selection"><i class="fa fa-bars" aria-hidden="true"></i></button>\n                                    <button class="fa-btn form-no-1-calculation-bulk-delete-bttn tltip" data-title="Delete Selection"><i class="fa fa-trash" aria-hidden="true"></i></button>\n                                    <a href="print/order-sheet-form-no-1-calculation-'+o+"-"+cid+'" target="_blank" class="fa-btn tltip dark" data-title="PDF | Order Sheet"><i class="fa fa-file-pdf-o" aria-hidden="true"></i> <small>Order Sheet in PDF</small></a>\n                                    <a href="https://file-gen.blinq.com.au/clients/'+user_account+"/order-sheet-xlsx-form-no-1-calculation-"+o+"-"+cid+'" target="_blank" class="fa-btn tltip dark" data-title="EXL | Order Sheet"><i class="fa fa-file-excel-o" aria-hidden="true"></i> <small>Order Sheet in EXL</small></a>\n                                    <form class="group-discount-form" style="float: right; margin-right: -6px; font-size: 12px;">\n                                        <input type="tel" class="group-total price-input ui-state-default" autocomplete="off" style="float: left;" disabled>\n                                        <input type="tel" class="group-discount price-input ui-state-default" autocomplete="off" placeholder="%" style="float: left; margin-left: 1px !important; margin-right: 1px !important; text-align: center; width: 33px;" required>\n                                        <input type="hidden" class="form-no-1-calculation-code" value="'+o+'">\n                                        <input type="submit" class="bttn-input ui-button ui-widget ui-state-default ui-corner-all" value="✔" role="button" aria-disabled="false" style="float: left;">\n                                    </form>\n                                    <div class="group-discount-total" style="float: right; line-height: 40px; margin-right: 400px; font-size: 22px; font-weight: bold;"></div>\n                                </div>').prependTo("#form-no-1-calculation-quote-items-results").find(".bttn-input, .bulk-action-button").button();var N='<tr class="thead-tr">\n                                                <th class="left-fixed-column">#</th>\n                                                '+u+"                                                "+n+"                                                "+p+"                                                "+c+"                                                "+d+'                                                <th>\n                                                    <table class="right-fixed-column">\n                                                        <tr>\n                                                        '+O+"\n                                                            <th>More</th>\n                                                            <th>Del</th>\n                                                        </tr>\n                                                    </table>\n                                                </th>\n                                            </tr>",J=0,P=0;$.each(a.quote_items,function(e,t){$('<form id="calculation-form-'+t.code+'" class="update-form-no-1-calculation-quote-item-form" action="./" method="POST">\n                                    <input type="hidden" name="calc-name" class="calc-name" value="form_no_1">\n                                    <input type="hidden" name="cid" class="cid" value="'+cid+'">\n                                    <input type="hidden" name="form-no-1-calculation-code" class="form-no-1-calculation-code" value="'+o+'">\n                                    <input type="hidden" name="form-no-1-calculation-quote-item-code" class="form-no-1-calculation-quote-item-code" value="'+t.code+'">\n                                    <table class="form-no-1-calculation-table">\n                                        <thead class="thead"></thead>\n                                        <tbody>\n                                            <tr>\n                                                <td class="left-fixed-column">\n                                                    <label class="checkbox-label" for="checkbox-'+t.code+'">'+t.row_no+'</label>\n                                                    <input type="checkbox" id="checkbox-'+t.code+'" class="checkbox-input" name="quote-item-codes[]" value="'+t.code+'">\n                                                    <input type="hidden" class="quote-item-row-no" name="quote-item-row-no[]" value="'+t.row_no+'">\n                                                </td>\n                                                '+f+"                                                "+i+"                                                "+m+"                                                "+r+"                                                "+s+'                                                </td>\n                                                <td>\n                                                    <table class="right-fixed-column" style="margin-top: -20px;">\n                                                        <tr>\n                                                            '+T+'\n                                                            <td><button type="button" class="form-no-1-calculation-table-more-bttn bttn-input table-more-bttn"><i class="fa fa-chevron-circle-down" aria-hidden="true"></i></button></td>\n                                                            <td><button type="button" class="bttn-input delete-form-no-1-calculation-quote-item"><i class="fa fa-trash" aria-hidden="true"></i></button></td>\n                                                        </tr>\n                                                    </table>\n                                                </td>\n                                            </tr>\n                                        </tbody>\n                                    </table>\n                                    <table id="calculation-table-more-'+t.code+'"  class="form-no-1-calculation-table-more">\n                                        <tr>\n                                            <td class="table-more-notes" colspan="3">\n                                                <textarea name="notes" data-column="notes" class="form-no-1-calculation-notes data-field" placeholder="Notes">'+t.notes+'</textarea>\n                                            </td>\n                                        </tr>\n                                        <tr>\n                                            <td class="table-more-accessories">\n                                                '+b+'                                            </td>\n                                            <td class="table-more-per-meters">\n                                                '+g+'                                            </td>\n                                            <td class="table-more-fitting-charges">\n                                                '+q+"                                            </td>\n                                        </tr>\n                                    </table>\n                                </form>").appendTo("#quote-items-body-"+o).queue(function(){var e=$(this);e.find("[name='location']").val(t.location),e.find("[name='type']").val(t.type).queue(function(){update_material(this),$(this).dequeue()}),e.find("[name='material']").val(t.material).queue(function(){update_colour(this),$(this).dequeue()}),e.find("[name='colour']").val(t.colour),"1"===quote_status&&e.find(".approved-disabled").css({"pointer-events":"none",background:"#f2f2f2"}),e.find("[name='price']").val(t.price).end().find("[name='qty']").val(t.qty).end().find("[name='total']").val(t.total),$.each(t.fields,function(t,a){var o=a.code,n=a.name,l=a.price,i=a.form_no_1_calculation_field_code;e.find("[name='field["+i+"]']").is("input")?e.find("[name='field["+i+"]']").val(n):e.find("[name='field["+i+"]']").val(n+"<->"+o+"<->"+l).attr("data-selected-sub-options",a.sub_options)}),$.each(t.accessories,function(t,a){var o=a.code,n=a.name,l=+a.price,i=+a.qty,c=(l*i).toFixed(2);e.find(".table-more-accessories").append('<span class="form-no-1-calculation-accessories-wrapper">\n                                                                                            <input type="text" class="form-no-1-calculation-accessory" readonly disabled value="'+n+" | "+l+" x "+i+" = "+c+'">\n                                                                                            <input type="button" class="delete-form-no-1-calculation-accessory bttn-input" data-code="'+o+'" value="✖">\n                                                                                        </span>'),e.find('.form-no-1-calculation-accessories option[data-code="'+o+'"]').hide()}),$.each(t.per_meters,function(t,a){var o=a.code,n=a.name,l=+a.price,i=+a.width,c=(l*i).toFixed(2);e.find(".table-more-per-meters").append('<span class="form-no-1-calculation-per-meters-wrapper">\n                                                                                            <input type="text" class="form-no-1-calculation-per-meter" readonly disabled value="'+n+" | "+l+" x "+i+" = "+c+'">\n                                                                                            <input type="button" class="delete-form-no-1-calculation-per-meter bttn-input" data-code="'+o+'" value="✖">\n                                                                                        </span>'),e.find('.form-no-1-calculation-per-meters option[data-code="'+o+'"]').hide()}),$.each(t.fitting_charges,function(t,a){var o=a.code,n=a.name,l=a.price;e.find(".table-more-fitting-charges").append('<span class="form-no-1-calculation-fitting-charges-wrapper">\n                                                                                                <input type="text" class="form-no-1-calculation-fitting-charge" readonly disabled value="'+n+" | "+l+'">\n                                                                                                <input type="button" class="delete-form-no-1-calculation-fitting-charge bttn-input" data-code="'+o+'" value="✖">\n                                                                                            </span>'),e.find('.form-no-1-calculation-fitting-charges option[data-code="'+o+'"]').hide()});var a=t.notes,o=e.find(".form-no-1-calculation-accessory").length,n=e.find(".form-no-1-calculation-per-meter").length,l=e.find(".form-no-1-calculation-fitting-charge").length;a||o||n||l?e.find(".form-no-1-calculation-table-more-bttn").addClass("red"):e.find(".form-no-1-calculation-table-more-bttn").removeClass("red"),0,J=+J+ +t.total,P=t.discount,e.find(".bttn-input, .checkbox-input").button(),e.dequeue()}).clearQueue().html()}),$("#form-no-1-calculation-quote-items-wrapper-"+o).find(".group-total").val(J.toFixed(2)).end().find(".group-discount").val(P).end().find(".group-discount-total").html(currency(J-J*P/100)),$(".form-no-1-calculation-quote-items-body .form-no-1-calculation-table .thead").first().html(N)}else $('<div id="form-no-1-calculation-quote-items-wrapper-'+o+'" class="form-no-1-calculation-quote-items-wrapper"></div>').append('<h2 class="form-no-1-calculation-header">'+a.name+"</h2>").append('<div id="quote-items-body-'+o+'" class="form-no-1-calculation-quote-items-body '+k+'"></div>').append('<div class="bulk-action-button-wrapper"></div>').prependTo("#form-no-1-calculation-quote-items-results").hide()}),$(".tabs").tabs("refresh").tabs("option","active",0)):alert(JSON.stringify(e))},error:function(e,t,a){alert(JSON.stringify(e))}})}),$(document).on("click",".form-no-1-calculation-bulk-delete-bttn",function(){var e=$(this),t=e.parents(".form-no-1-calculation-quote-items-wrapper"),a=t.find(".form-no-1-calculation-table .thead .thead-tr:first").clone(),o=t.find(".checkbox-input:checked"),n=o.serialize()+"&cid="+cid;n&&iziToast.question({rtl:!1,color:"#ed1d24",titleColor:"white",messageColor:"white",layout:1,timeout:!1,close:!1,closeOnEscape:!0,overlay:!0,displayMode:1,progressBar:!0,title:"Hey!",message:"Wanna Delete?",position:"center",buttons:[["<button><b>Yes</b></button>",function(l,i,c,r,d){l.hide({transitionOut:"fadeOut"},i,"button"),$.ajax({url:"form-no-1-calculation/scripts/delete-bulk-form-no-1-calculation-quote-items.php",type:"POST",dataType:"json",data:n,beforeSend:function(){e.prop("disabled",!1).addClass("field-loader")},success:function(n){4===n[0]?document.location.replace(n[1]):2===n[0]?(e.prop("disabled",!1).removeClass("field-loader"),alert(n[1])):1===n[0]?($.each(o.serializeArray(),function(e,t){
$("#calculation-form-"+t.value).remove()}),t.find(".update-form-no-1-calculation-quote-item-form").length?t.find(".form-no-1-calculation-table .thead").first().html(a):t.hide().find(".bulk-action-button-wrapper").empty(),e.prop("disabled",!1).removeClass("field-loader"),form_no_1_calculation_group_discount(e),$("#getsum").load("getsum.php?cid="+cid).fadeIn("fast"),$("#totalx").load("megaTotal.php?cid="+cid).fadeIn("fast")):(e.prop("disabled",!1).removeClass("field-loader"),alert(JSON.stringify(n)))},error:function(t,a,o){e.prop("disabled",!1).removeClass("field-loader"),alert(JSON.stringify(t)),alert("Error! @delete-bulk-form-no-1-calculation-quote-item")}})},!1],["<button><b>No</b></button>",function(e,t,a,o){e.hide({transitionOut:"fadeOut"},t,"button")},!0]],onClosing:function(e,t,a){},onClosed:function(e,t,a){}})}),$(document).on("click",".form-no-1-calculation-bulk-copy-bttn",function(){var e=$(this),t=e.parents(".form-no-1-calculation-quote-items-wrapper"),a=t.find(".checkbox-input:checked"),o=a.serialize(),n=e.siblings(".group-discount-form").find(".form-no-1-calculation-code").val(),l=-1/0;$(document).find("#quote-items-body-"+n).find(".quote-item-row-no").each(function(){l=Math.max(l,parseFloat(this.value))});var i=l+1;o&&$.ajax({url:"form-no-1-calculation/scripts/copy-bulk-form-no-1-calculation-quote-items.php",type:"POST",dataType:"json",data:o+"&cid="+cid,beforeSend:function(){e.prop("disabled",!1).addClass("field-loader")},success:function(a){4===a[0]?document.location.replace(a[1]):2===a[0]?(e.prop("disabled",!1).removeClass("field-loader"),alert(a[1])):1===a[0]?($.each(a[1],function(e,a){var o=$("#calculation-form-"+e).clone();o.attr("id","calculation-form-"+a),o.find(".form-no-1-calculation-quote-item-code").val(a),o.find(".checkbox-label").attr("for","checkbox-"+a).html(i),o.find(".checkbox-input").attr("id","checkbox-"+a).val(a),o.find(".checkbox-input").button(),o.find(".quote-item-row-no").val(i),o.find(".form-no-1-calculation-table-more").attr("id","calculation-table-more-"+a).hide(),o.find(".form-no-1-calculation-table .thead").empty(),i++,$(o).appendTo(t.find(".form-no-1-calculation-quote-items-body")).queue(function(){var t=$(this),a=$("#calculation-form-"+e);$.each(a.serializeArray(),function(e,a){t.find(".data-field[name='"+a.name+"']").val(a.value)}),update_selected_sub_options(t,!0),t.dequeue()}).clearQueue()}),e.prop("disabled",!1).removeClass("field-loader"),form_no_1_calculation_group_discount(e)):(e.prop("disabled",!1).removeClass("field-loader"),alert(JSON.stringify(a)))},error:function(t,a,o){e.prop("disabled",!1).removeClass("field-loader"),alert(JSON.stringify(t)),alert("Error! @copy-bulk-form-no-1-calculation-quote-item")}})}),$(document).on("click",".delete-form-no-1-calculation-quote-item",function(){var e=$(this),t=e.parents(".update-form-no-1-calculation-quote-item-form"),a=t.find(".form-no-1-calculation-quote-item-code").val(),o=t.parents(".form-no-1-calculation-quote-items-wrapper"),n=o.find(".form-no-1-calculation-table .thead .thead-tr:first").clone();iziToast.question({rtl:!1,color:"#ed1d24",titleColor:"white",messageColor:"white",layout:1,timeout:!1,close:!1,closeOnEscape:!0,overlay:!0,displayMode:1,progressBar:!0,title:"Hey!",message:"Wanna delete this item?",position:"center",buttons:[["<button><b>Yes</b></button>",function(l,i,c,r,d){l.hide({transitionOut:"fadeOut"},i,"button"),$.ajax({url:"form-no-1-calculation/scripts/delete-form-no-1-calculation-quote-item.php",type:"POST",dataType:"json",data:{cid:cid,code:a},beforeSend:function(){e.prop("disabled",!0).addClass("field-loader")},success:function(a){4===a[0]?document.location.replace(a[1]):2===a[0]?(e.prop("disabled",!1).removeClass("field-loader"),alert(a[1])):1===a[0]?(t.hide(),e.prop("disabled",!1).removeClass("field-loader"),form_no_1_calculation_group_discount(t),$("#getsum").load("getsum.php?cid="+cid).fadeIn("fast"),$("#totalx").load("megaTotal.php?cid="+cid).fadeIn("fast"),t.remove(),o.find(".form-no-1-calculation-table .thead").first().html(n),o.find(".update-form-no-1-calculation-quote-item-form").length||o.hide().find(".bulk-action-button-wrapper").empty()):(e.prop("disabled",!1).removeClass("field-loader"),alert(JSON.stringify(a)))},error:function(t,a,o){e.prop("disabled",!1).removeClass("field-loader"),alert(JSON.stringify(t)),alert("Error! @delete-form-no-1-calculation-quote-item")}})},!1],["<button><b>No</b></button>",function(e,t,a,o){e.hide({transitionOut:"fadeOut"},t,"button")},!0]],onOpening:function(t,a,o){e.find(".fa").removeClass("fa-trash").addClass("fa-spin fa-spinner red")},onClosing:function(e,t,a){},onClosed:function(t,a,o){e.find(".fa").addClass("fa-trash").removeClass("fa-spin fa-spinner red")}})}),$(document).on("click",".form-no-1-calculation-table-more-bttn",function(){var e=$(this),t=e.parents("form");e.find(".fa").toggleClass("rotate"),t.find(".form-no-1-calculation-table-more").toggle("slide",{direction:"up"},"fast")}),$(document).on("change",".checkbox-input",function(){var e=$(this),t=e.parents(".form-no-1-calculation-table");e.is(":checked")?t.find("select, .number-input, .text-field").addClass("ui-state-default"):t.find("select, .number-input, .text-field").removeClass("ui-state-default")}),$(document).on("change",".add-form-no-1-calculation-quote-item-form .form-no-1-calculation-cost,\n                                .add-form-no-1-calculation-quote-item-form .form-no-1-calculation-markup,\n                                .add-form-no-1-calculation-quote-item-form .form-no-1-calculation-field",function(){get_form_no_1_calculation_price(this)}),$(document).on("change",".add-form-no-1-calculation-quote-item-form .form-no-1-calculation-price, .add-form-no-1-calculation-quote-item-form .form-no-1-calculation-qty",function(){var e=$(this).parents("form");update_form_no_1_calculation_total_price(e)}),$(document).on("change",".form-no-1-calculation-field",function(e){var t=$(this),a=t.parents("form"),o=t.siblings(".form-no-1-calculation-add-field-option-wrapper"),n=o.find(".form-no-1-calculation-add-field-option"),l=a.find(".data-field, .number-input, select, [type='submit']"),i=t.siblings(".comboTree-btn"),c=a.find(".checkbox-input"),r=a.parents(".form-no-1-calculation-quote-items-body").find(".checkbox-input:checked");c.is(":checked")&&r.length&&r.not(c).each(function(){var e=$(this).parents(".update-form-no-1-calculation-quote-item-form"),a=e.find(".data-field, .number-input, select, [type='submit']");"add-new"===t.val()&&a.prop("disabled",!0)}),"add-new"===t.val()&&(t.hide(),i.hide(),o.show(),n.focus(),l.prop("disabled",!0))}),$(document).on("keypress",".form-no-1-calculation-add-field-option, .form-no-1-calculation-add-field-option-price",function(e){if(13===e.keyCode){e.preventDefault();var t=$(this),a=t.parents(".form-no-1-calculation-add-field-option-wrapper"),o=a.find(".form-no-1-calculation-add-field-option"),n=a.find(".form-no-1-calculation-add-field-option-price"),l=o.val(),i=n.val();return form_no_1_calculation_add_field_option(l,i,t),!1}}),$(document).on("click",".form-no-1-calculation-add-field-option-submit",function(e){e.preventDefault();var t=$(this),a=t.siblings(".form-no-1-calculation-add-field-option"),o=t.siblings(".form-no-1-calculation-add-field-price-option"),n=a.val(),l=o.val();return form_no_1_calculation_add_field_option(n,l,t),!1}),$(document).on("click",".form-no-1-calculation-add-field-option-close",function(){var e=$(this),t=e.parents("form"),a=e.parents(".form-no-1-calculation-add-field-option-wrapper"),o=a.find(".form-no-1-calculation-add-field-option"),n=a.siblings(".form-no-1-calculation-field"),l=t.find(".data-field, .number-input, select, [type='submit']"),i=n.siblings(".comboTree-btn"),c=t.find(".checkbox-input"),r=t.parents(".form-no-1-calculation-quote-items-body").find(".checkbox-input:checked");c.is(":checked")&&r.length&&r.not(c).each(function(){var e=$(this).parents(".update-form-no-1-calculation-quote-item-form"),t=e.find(".data-field, .number-input, select, [type='submit']");t.prop("disabled",!1)}),o.val(""),a.hide(),l.prop("disabled",!1),i.show(),n.show().val("").change().focus()}),$(document).on("submit",".add-form-no-1-calculation-quote-item-form",function(e){e.preventDefault();var t=$(this),a=t.find('[type="submit"]'),o=t.find(".form-no-1-calculation-table .thead-tr"),n=t.find(".form-no-1-calculation-table .tbody-tr"),l=t.find(".form-no-1-calculation-code").val(),i=t.find(".accessory-option-array").val(),c=t.find(".per-meter-option-array").val(),r=t.find(".fitting-charge-option-array").val(),d=t.hasClass("qty_on")?"qty_on":"",s=$("#form-no-1-calculation-quote-items-wrapper-"+l),u=$.isNumeric(+s.find(".group-discount").val())?+s.find(".group-discount").val():0,f=t.serialize();if(d)var p="<th>Price</th><th>Qty</th><th>Total</th>",m='<td><input type="tel" name="price" class="form-no-1-calculation-price price-input data-field" autocomplete="off"></td><td><input type="number" name="qty" class="form-no-1-calculation-qty number-input data-field" autocomplete="off" min="1" value="1"></td><td><input type="number" name="total" class="form-no-1-calculation-total number-input" autocomplete="off" min="1" value="" readonly><input type="hidden" class="data-field" name="qty_field" value="on"></td>';else p="<th>Price</th>",m='<td><input type="tel" name="price" data-column="price" class="form-no-1-calculation-price price-input data-field ui-state-default" autocomplete="off" value=""><input type="hidden" name="qty" class="form-no-1-calculation-qty number-input data-field" autocomplete="off" min="1" value="0"><input type="hidden" name="total" data-column="total" class="form-no-1-calculation-total price-input data-field ui-state-default" autocomplete="off" value="" readonly><input type="hidden" class="data-field" name="qty_field" value="off"></td>';var b=-1/0;$(document).find("#quote-items-body-"+l).find(".quote-item-row-no").each(function(){b=Math.max(b,parseFloat(this.value))});var h=b==-1/0?1:b+1;$.ajax({url:"form-no-1-calculation/scripts/add-form-no-1-calculation-quote-item.php",type:"POST",dataType:"json",data:f,beforeSend:function(e){a.prop("disabled",!1).addClass("field-loader")},success:function(e){4===e[0]?document.location.replace(e[1]):2===e[0]?(a.prop("disabled",!1).removeClass("field-loader"),alert(e[1])):1===e[0]?($(t).find(".data-field:first").focus(),$.each(e[1],function(e,a){if($("#quote-items-body-"+l+" .form-no-1-calculation-table").length)u="";else{var s=o.clone();s.prepend('<th class="left-fixed-column">#</th>'),s.find(".right-fixed-column").html("<tr>\n                                                                                    "+p+"\n                                                                                    <th>More</th>\n                                                                                    <th>Del</th>\n                                                                                </tr>");var u=s.html();$("#form-no-1-calculation-quote-items-wrapper-"+l).show()}var f=n.clone();if(f.prepend('<td class="left-fixed-column">\n                                <label class="checkbox-label" for="checkbox-'+a+'">'+h+'</label>\n                                <input type="checkbox" id="checkbox-'+a+'" class="checkbox-input" name="quote-item-codes[]" value="'+a+'">\n                                <input type="hidden" class="quote-item-row-no" name="quote-item-row-no[]" value="'+h+'">\n                            </td>'),f.find(".right-fixed-column").html("<tr>\n                                                                                "+m+'\n                                                                                <td><button type="button" class="form-no-1-calculation-table-more-bttn bttn-input table-more-bttn"><i class="fa fa-chevron-circle-down" aria-hidden="true"></i></button></td>\n                                                                                <td><button type="button" class="bttn-input delete-form-no-1-calculation-quote-item"><i class="fa fa-trash" aria-hidden="true"></i></button></td>\n                                                                            </tr>'),"1"===quote_status&&f.find(".approved-disabled").css({"pointer-events":"none",background:"#f2f2f2"}),i){var b="",v="";$.each(JSON.parse(i),function(e,t){v+='<option data-code="'+t.code+'" value="'+t.code+"<->"+t.name+"<->"+t.price+'">'+t.name+" | "+t.price+"</option>"}),b='<span class="form-no-1-calculation-accessories-wrapper">\n                                                    <select class="form-no-1-calculation-accessories">\n                                                        <option value="">Accessories</option>\n                                                        '+v+'                                                    </select>\n                                                    <input type="tel" class="add-form-no-1-calculation-accessory-qty qty-input" placeholder="Qty">\n                                                    <input type="button" class="add-form-no-1-calculation-accessories bttn-input" value="✚">\n                                                </span>'}else b="";if(c){var g="",y="";$.each(JSON.parse(c),function(e,t){y+='<option data-code="'+t.code+'" value="'+t.code+"<->"+t.name+"<->"+t.price+'">'+t.name+" | "+t.price+"</option>"}),g='<span class="form-no-1-calculation-per-meters-wrapper">\n                                                    <select class="form-no-1-calculation-per-meters">\n                                                        <option value="">Per Meters</option>\n                                                        '+y+'                                                    </select>\n                                                    <input type="tel" class="add-form-no-1-calculation-per-meter-width qty-input" placeholder="Width">\n                                                    <input type="button" class="add-form-no-1-calculation-per-meters bttn-input" value="✚">\n                                                </span>'}else g="";if(r){var _="",q="";$.each(JSON.parse(r),function(e,t){q+='<option data-code="'+t.code+'" value="'+t.code+"<->"+t.name+"<->"+t.price+'">'+t.name+" | "+t.price+"</option>"}),_='<span class="form-no-1-calculation-fitting-charges-wrapper">\n                                                        <select class="form-no-1-calculation-fitting-charges">\n                                                            <option value="">Fitting Charges</option>\n                                                            '+q+'                                                        </select>\n                                                        <input type="button" class="add-form-no-1-calculation-fitting-charges bttn-input" value="✚">\n                                                    </span>'}else _="";$('<form id="calculation-form-'+a+'" class="update-form-no-1-calculation-quote-item-form" action="./" method="POST">\n                                <input type="hidden" name="calc-name" class="calc-name" value="form_no_1">\n                                <input type="hidden" name="cid" class="cid" value="'+cid+'">\n                                <input type="hidden" name="form-no-1-calculation-code" class="form-no-1-calculation-code" value="'+l+'">\n                                <input type="hidden" name="form-no-1-calculation-quote-item-code" class="form-no-1-calculation-quote-item-code" value="'+a+'">\n                                <table class="form-no-1-calculation-table '+d+'">\n                                    <thead class="thead">\n                                        <tr class="thead-tr">'+u+"</tr>\n                                    </thead>\n                                    <tbody>\n                                        "+f.html()+'                                    </tbody>\n                                </table>\n                                <table id="calculation-table-more-'+a+'"  class="form-no-1-calculation-table-more">\n                                    <tr>\n                                        <td class="table-more-notes" colspan="3">\n                                            <textarea name="notes" data-column="notes" class="form-no-1-calculation-notes data-field" placeholder="Notes"></textarea>\n                                        </td>\n                                    </tr>\n                                    <tr>\n                                        <td class="table-more-accessories">\n                                            '+b+'                                        </td>\n                                        <td class="table-more-per-meters">\n                                            '+g+'                                        </td>\n                                        <td class="table-more-fitting-charges">\n                                            '+_+"                                        </td>\n                                    </tr>\n                                </table>\n                            </form>").appendTo("#quote-items-body-"+l).queue(function(){var e=$(this);$.each(t.serializeArray(),function(t,a){e.find("[name='"+a.name+"']").val(a.value)}),e.find(".bttn-input, .checkbox-input").button(),update_selected_sub_options(e,!0),e.dequeue()}).clearQueue(),h++}),s.find(".bulk-action-button-wrapper").html('<button class="fa-btn quote-item-select-all-bttn tltip" data-title="Select All"><i class="fa fa-square" aria-hidden="true"></i></button>\n                        <button class="fa-btn quote-item-sort-bttn tltip" data-title="Sort Selection"><i class="fa fa-sort" aria-hidden="true"></i></button>\n                        <button class="fa-btn form-no-1-calculation-bulk-copy-bttn tltip" data-title="Copy Selection"><i class="fa fa-bars" aria-hidden="true"></i></button>\n                        <button class="fa-btn form-no-1-calculation-bulk-delete-bttn tltip" data-title="Delete Selection"><i class="fa fa-trash" aria-hidden="true"></i></button>\n                        <a href="print/order-sheet-form-no-1-calculation-'+l+"-"+cid+'" target="_blank" class="fa-btn tltip dark" data-title="PDF | Order Sheet"><i class="fa fa-file-pdf-o" aria-hidden="true"></i> <small>Order Sheet in PDF</small></a>\n                        <a href="https://file-gen.blinq.com.au/clients/'+user_account+"/order-sheet-xlsx-form-no-1-calculation-"+l+"-"+cid+'" target="_blank" class="fa-btn tltip dark" data-title="EXL | Order Sheet"><i class="fa fa-file-excel-o" aria-hidden="true"></i> <small>Order Sheet in EXL</small></a>\n                        <form class="group-discount-form" style="float: right; margin-right: -6px; font-size: 12px;">\n                            <input type="tel" class="group-total price-input ui-state-default" autocomplete="off" style="float: left;" disabled value="">\n                            <input type="tel" class="group-discount price-input ui-state-default" autocomplete="off" placeholder="%" value="'+u+'" style="float: left; margin-left: 1px !important; margin-right: 1px !important; text-align: center; width: 33px;" required value="">\n                            <input type="hidden" class="form-no-1-calculation-code" value="'+l+'">\n                            <input type="submit" class="bttn-input ui-button ui-widget ui-state-default ui-corner-all" value="✔" role="button" aria-disabled="false" style="float: left;">\n                        </form>\n                        <div class="group-discount-total" style="float: right; line-height: 40px; margin-right: 400px; font-size: 22px; font-weight: bold;"></div>\n                    ').find(".bulk-action-button").button(),t[0].reset(),t.find(".form-no-1-calculation-material").val("").find("option").not(":first").remove(),t.find(".form-no-1-calculation-colour").val("").find("option").not(":first").remove(),a.prop("disabled",!1).removeClass("field-loader"),form_no_1_calculation_group_discount(s.find(".group-discount-form"))):(a.prop("disabled",!1).removeClass("field-loader"),alert(JSON.stringify(e)))},error:function(e,t,o){a.prop("disabled",!1).removeClass("field-loader"),alert(JSON.stringify(e)),alert("Error! @add-form-no-1-calculation-quote-item")}})}),$(document).on("change",".update-form-no-1-calculation-quote-item-form .data-field",function(e){e.preventDefault();var t=$(this),a=t.attr("name"),o=t.val();if("add-new"===o)return!1;t.toggleClass("field-loader");var n=t.parents(".update-form-no-1-calculation-quote-item-form"),l=n.find(".checkbox-input"),i=n.parents(".form-no-1-calculation-quote-items-body").find(".checkbox-input:checked"),c="";if(l.is(":checked")&&i.length){c=[];var r=0;i.each(function(){var e=$(this).parents(".update-form-no-1-calculation-quote-item-form"),n=e.find("[name='"+a+"']");n.val(o),("cost"===n.attr("name")||"markup"===n.attr("name")||n.hasClass("form-no-1-calculation-field"))&&"1"!==quote_status&&get_form_no_1_calculation_price(n),("price"===n.attr("name")||"qty"===n.attr("name")||n.hasClass("form-no-1-calculation-field"))&&"1"!==quote_status&&update_form_no_1_calculation_total_price(e),"cost"===n.attr("name")||"markup"===n.attr("name")||n.hasClass("form-no-1-calculation-field")?"1"!==quote_status?(get_form_no_1_calculation_price(n),r+=1,c.push(e.serialize()),i.length===r&&update_form_no_1_calculation_quote_item(t,c)):(r+=1,get_form_no_1_calculation_price(n),c.push(e.serialize()),i.length===r&&update_form_no_1_calculation_quote_item(t,c)):(r+=1,c.push(e.serialize()),i.length===r&&update_form_no_1_calculation_quote_item(t,c))})}else("cost"===t.attr("name")||"markup"===t.attr("name")||t.hasClass("form-no-1-calculation-field"))&&"1"!==quote_status&&get_form_no_1_calculation_price(t),("price"===t.attr("name")||"qty"===t.attr("name")||t.hasClass("form-no-1-calculation-field"))&&"1"!==quote_status&&update_form_no_1_calculation_total_price(n),"cost"===t.attr("name")||"markup"===t.attr("name")||t.hasClass("form-no-1-calculation-field")?(quote_status,get_form_no_1_calculation_price(t),c=[n.serialize()],update_form_no_1_calculation_quote_item(t,c)):(c=[n.serialize()],update_form_no_1_calculation_quote_item(t,c))}),$(document).on("keypress",".add-form-no-1-calculation-accessory-qty",function(e){if(13===e.keyCode){e.preventDefault();var t=$(this),a=t.siblings(".add-form-no-1-calculation-accessories");a.click()}}),$(document).on("click",".add-form-no-1-calculation-accessories",function(){var e=$(this),t=e.parents(".update-form-no-1-calculation-quote-item-form"),a=e.siblings(".form-no-1-calculation-accessories"),o=e.siblings(".add-form-no-1-calculation-accessory-qty"),n=t.find(".form-no-1-calculation-code").val(),l=t.find(".form-no-1-calculation-quote-item-code").val(),i=a.val(),c=+o.val();c=0!==c?c:1,i&&$.ajax({url:"form-no-1-calculation/scripts/add-form-no-1-calculation-quote-item-accessory.php",type:"POST",dataType:"json",data:{cid:cid,form_no_1_calculation_code:n,form_no_1_calculation_quote_item_code:l,accessory:i,accessory_qty:c},beforeSend:function(){e.prop("disabled",!1).addClass("field-loader"),a.addClass("field-loader"),o.addClass("field-loader")},success:function(n){if(4===n[0])document.location.replace(n[1]);else if(2===n[0])e.prop("disabled",!1).removeClass("field-loader"),a.removeClass("field-loader"),o.removeClass("field-loader"),alert(n[1]);else if(1===n[0]){var l=i.split("<->")[0],r=i.split("<->")[1],d=+i.split("<->")[2].replace(/,/g,""),s=(d*c).toFixed(2);t.find(".table-more-accessories").append('<span class="form-no-1-calculation-accessories-wrapper">\n                                                                                <input type="text" class="form-no-1-calculation-accessory" readonly disabled value="'+r+" | "+d+" x "+c+" = "+s+'">\n                                                                                <input type="button" class="delete-form-no-1-calculation-accessory bttn-input" data-code="'+l+'" value="✖">\n                                                                            </span>').find(".bttn-input").button(),a.find('option[data-code="'+l+'"]').hide(),a.val("").focus(),o.val("");var u=t.find(".form-no-1-calculation-notes").val().length,f=t.find(".form-no-1-calculation-accessory").length,p=t.find(".form-no-1-calculation-per-meter").length,m=t.find(".form-no-1-calculation-fitting-charge").length;u||f||p||m?t.find(".form-no-1-calculation-table-more-bttn").addClass("red"):t.find(".form-no-1-calculation-table-more-bttn").removeClass("red"),e.prop("disabled",!1).removeClass("field-loader"),a.removeClass("field-loader"),o.removeClass("field-loader"),$("#getsum").load("getsum.php?cid="+cid).fadeIn("fast"),$("#totalx").load("megaTotal.php?cid="+cid).fadeIn("fast")}else e.prop("disabled",!1).removeClass("field-loader"),a.removeClass("field-loader"),o.removeClass("field-loader"),alert(JSON.stringify(n))},error:function(t,n,l){e.prop("disabled",!1).removeClass("field-loader"),a.removeClass("field-loader"),o.removeClass("field-loader"),alert(JSON.stringify(t)),alert("Error! @add-form-no-1-calculation-quote-item-accessory")}})}),$(document).on("click",".delete-form-no-1-calculation-accessory",function(){var e=$(this),t=e.parents(".update-form-no-1-calculation-quote-item-form"),a=t.find(".form-no-1-calculation-accessories"),o=e.parent(".form-no-1-calculation-accessories-wrapper"),n=t.find(".form-no-1-calculation-code").val(),l=t.find(".form-no-1-calculation-quote-item-code").val(),i=e.attr("data-code");$.ajax({url:"form-no-1-calculation/scripts/delete-form-no-1-calculation-quote-item-accessory.php",type:"POST",dataType:"json",data:{cid:cid,form_no_1_calculation_code:n,form_no_1_calculation_quote_item_code:l,accessory_code:i},beforeSend:function(){e.prop("disabled",!1).addClass("field-loader")},success:function(n){if(4===n[0])document.location.replace(n[1]);else if(2===n[0])e.prop("disabled",!1).removeClass("field-loader"),alert(n[1]);else if(1===n[0]){o.remove(),a.find('option[data-code="'+i+'"]').show(),a.val("");var l=t.find(".form-no-1-calculation-notes").val().length,c=t.find(".form-no-1-calculation-accessory").length,r=t.find(".form-no-1-calculation-per-meter").length,d=t.find(".form-no-1-calculation-fitting-charge").length;l||c||r||d?t.find(".form-no-1-calculation-table-more-bttn").addClass("red"):t.find(".form-no-1-calculation-table-more-bttn").removeClass("red"),e.prop("disabled",!1).removeClass("field-loader"),$("#getsum").load("getsum.php?cid="+cid).fadeIn("fast"),$("#totalx").load("megaTotal.php?cid="+cid).fadeIn("fast")}else e.prop("disabled",!1).removeClass("field-loader"),alert(JSON.stringify(n))},error:function(t,a,o){e.prop("disabled",!1).removeClass("field-loader"),alert(JSON.stringify(t)),alert("Error! @delete-form-no-1-calculation-quote-item-accessory")}})}),$(document).on("keypress",".add-form-no-1-calculation-per-meter-width",function(e){if(13===e.keyCode){e.preventDefault();var t=$(this),a=t.siblings(".add-form-no-1-calculation-per-meters");a.click()}}),$(document).on("click",".add-form-no-1-calculation-per-meters",function(){var e=$(this),t=e.parents(".update-form-no-1-calculation-quote-item-form"),a=e.siblings(".form-no-1-calculation-per-meters"),o=e.siblings(".add-form-no-1-calculation-per-meter-width"),n=t.find(".form-no-1-calculation-code").val(),l=t.find(".form-no-1-calculation-quote-item-code").val(),i=a.val(),c=+o.val();c=0!==c?c:1,i&&$.ajax({url:"form-no-1-calculation/scripts/add-form-no-1-calculation-quote-item-per-meter.php",type:"POST",dataType:"json",data:{cid:cid,form_no_1_calculation_code:n,form_no_1_calculation_quote_item_code:l,per_meter:i,per_meter_width:c},beforeSend:function(){e.prop("disabled",!1).addClass("field-loader"),a.addClass("field-loader"),o.addClass("field-loader")},success:function(n){if(4===n[0])document.location.replace(n[1]);else if(2===n[0])e.prop("disabled",!1).removeClass("field-loader"),a.removeClass("field-loader"),o.removeClass("field-loader"),alert(n[1]);else if(1===n[0]){var l=i.split("<->")[0],r=i.split("<->")[1],d=+i.split("<->")[2].replace(/,/g,""),s=(d*c).toFixed(2);t.find(".table-more-per-meters").append('<span class="form-no-1-calculation-per-meters-wrapper">\n                                                                                <input type="text" class="form-no-1-calculation-per-meter" readonly disabled value="'+r+" | "+d+" x "+c+" = "+s+'">\n                                                                                <input type="button" class="delete-form-no-1-calculation-per-meter bttn-input" data-code="'+l+'" value="✖">\n                                                                            </span>').find(".bttn-input").button(),a.find('option[data-code="'+l+'"]').hide(),a.val("").focus(),o.val("");var u=t.find(".form-no-1-calculation-notes").val().length,f=t.find(".form-no-1-calculation-accessory").length,p=t.find(".form-no-1-calculation-per-meter").length,m=t.find(".form-no-1-calculation-fitting-charge").length;u||f||p||m?t.find(".form-no-1-calculation-table-more-bttn").addClass("red"):t.find(".form-no-1-calculation-table-more-bttn").removeClass("red"),e.prop("disabled",!1).removeClass("field-loader"),a.removeClass("field-loader"),o.removeClass("field-loader"),$("#getsum").load("getsum.php?cid="+cid).fadeIn("fast"),$("#totalx").load("megaTotal.php?cid="+cid).fadeIn("fast")}else e.prop("disabled",!1).removeClass("field-loader"),a.removeClass("field-loader"),o.removeClass("field-loader"),alert(JSON.stringify(n))},error:function(t,n,l){e.prop("disabled",!1).removeClass("field-loader"),a.removeClass("field-loader"),o.removeClass("field-loader"),alert(JSON.stringify(t)),alert("Error! @add-form-no-1-calculation-quote-item-per-meter")}})}),$(document).on("click",".delete-form-no-1-calculation-per-meter",function(){var e=$(this),t=e.parents(".update-form-no-1-calculation-quote-item-form"),a=t.find(".form-no-1-calculation-per-meters"),o=e.parent(".form-no-1-calculation-per-meters-wrapper"),n=t.find(".form-no-1-calculation-code").val(),l=t.find(".form-no-1-calculation-quote-item-code").val(),i=e.attr("data-code");$.ajax({url:"form-no-1-calculation/scripts/delete-form-no-1-calculation-quote-item-per-meter.php",type:"POST",dataType:"json",data:{cid:cid,form_no_1_calculation_code:n,form_no_1_calculation_quote_item_code:l,per_meter_code:i},beforeSend:function(){e.prop("disabled",!1).addClass("field-loader")},success:function(n){if(4===n[0])document.location.replace(n[1]);else if(2===n[0])e.prop("disabled",!1).removeClass("field-loader"),alert(n[1]);else if(1===n[0]){o.remove(),a.find('option[data-code="'+i+'"]').show(),a.val("");var l=t.find(".form-no-1-calculation-notes").val().length,c=t.find(".form-no-1-calculation-accessory").length,r=t.find(".form-no-1-calculation-per-meter").length,d=t.find(".form-no-1-calculation-fitting-charge").length;l||c||r||d?t.find(".form-no-1-calculation-table-more-bttn").addClass("red"):t.find(".form-no-1-calculation-table-more-bttn").removeClass("red"),e.prop("disabled",!1).removeClass("field-loader"),$("#getsum").load("getsum.php?cid="+cid).fadeIn("fast"),$("#totalx").load("megaTotal.php?cid="+cid).fadeIn("fast")}else e.prop("disabled",!1).removeClass("field-loader"),alert(JSON.stringify(n))},error:function(t,a,o){e.prop("disabled",!1).removeClass("field-loader"),alert(JSON.stringify(t)),alert("Error! @delete-form-no-1-calculation-quote-item-accessory")}})}),$(document).on("click",".add-form-no-1-calculation-fitting-charges",function(){var e=$(this),t=e.parents(".update-form-no-1-calculation-quote-item-form"),a=e.siblings(".form-no-1-calculation-fitting-charges"),o=t.find(".form-no-1-calculation-code").val(),n=t.find(".form-no-1-calculation-quote-item-code").val(),l=a.val();l&&$.ajax({url:"form-no-1-calculation/scripts/add-form-no-1-calculation-quote-item-fitting-charge.php",type:"POST",dataType:"json",data:{cid:cid,form_no_1_calculation_code:o,form_no_1_calculation_quote_item_code:n,fitting_charge:l},beforeSend:function(){e.prop("disabled",!1).addClass("field-loader"),a.toggleClass("field-loader")},success:function(o){if(4===o[0])document.location.replace(o[1]);else if(2===o[0])e.prop("disabled",!1).removeClass("field-loader"),a.toggleClass("field-loader"),alert(o[1]);else if(1===o[0]){var n=l.split("<->")[0],i=l.split("<->")[1],c=l.split("<->")[2]
;t.find(".table-more-fitting-charges").append('<span class="form-no-1-calculation-fitting-charges-wrapper">\n                                                                                    <input type="text" class="form-no-1-calculation-fitting-charge" readonly disabled value="'+i+" | "+c+'">\n                                                                                    <input type="button" class="delete-form-no-1-calculation-fitting-charge bttn-input" data-code="'+n+'" value="✖">\n                                                                                </span>').find(".bttn-input").button(),a.find('option[data-code="'+n+'"]').hide(),a.val("");var r=t.find(".form-no-1-calculation-notes").val().length,d=t.find(".form-no-1-calculation-accessory").length,s=t.find(".form-no-1-calculation-fitting-charge").length;r||d||s?t.find(".form-no-1-calculation-table-more-bttn").addClass("red"):t.find(".form-no-1-calculation-table-more-bttn").removeClass("red"),e.prop("disabled",!1).removeClass("field-loader"),a.toggleClass("field-loader"),$("#getsum").load("getsum.php?cid="+cid).fadeIn("fast"),$("#totalx").load("megaTotal.php?cid="+cid).fadeIn("fast")}else e.prop("disabled",!1).removeClass("field-loader"),a.toggleClass("field-loader"),alert(JSON.stringify(o))},error:function(t,o,n){e.prop("disabled",!1).removeClass("field-loader"),a.toggleClass("field-loader"),alert(JSON.stringify(t)),alert("Error! @add-form-no-1-calculation-quote-item-fitting-charge")}})}),$(document).on("click",".delete-form-no-1-calculation-fitting-charge",function(){var e=$(this),t=e.parents(".update-form-no-1-calculation-quote-item-form"),a=t.find(".form-no-1-calculation-fitting-charges"),o=e.parent(".form-no-1-calculation-fitting-charges-wrapper"),n=t.find(".form-no-1-calculation-code").val(),l=t.find(".form-no-1-calculation-quote-item-code").val(),i=e.attr("data-code");$.ajax({url:"form-no-1-calculation/scripts/delete-form-no-1-calculation-quote-item-fitting-charge.php",type:"POST",dataType:"json",data:{cid:cid,form_no_1_calculation_code:n,form_no_1_calculation_quote_item_code:l,fitting_charge_code:i},beforeSend:function(){e.prop("disabled",!1).addClass("field-loader")},success:function(n){if(4===n[0])document.location.replace(n[1]);else if(2===n[0])e.prop("disabled",!1).removeClass("field-loader"),alert(n[1]);else if(1===n[0]){o.remove(),a.find('option[data-code="'+i+'"]').show(),a.val("");var l=t.find(".form-no-1-calculation-notes").val().length,c=t.find(".form-no-1-calculation-accessory").length,r=t.find(".form-no-1-calculation-fitting-charge").length;l||c||r?t.find(".form-no-1-calculation-table-more-bttn").addClass("red"):t.find(".form-no-1-calculation-table-more-bttn").removeClass("red"),e.prop("disabled",!1).removeClass("field-loader"),$("#getsum").load("getsum.php?cid="+cid).fadeIn("fast"),$("#totalx").load("megaTotal.php?cid="+cid).fadeIn("fast")}else e.prop("disabled",!1).removeClass("field-loader"),alert(JSON.stringify(n))},error:function(t,a,o){e.prop("disabled",!1).removeClass("field-loader"),alert(JSON.stringify(t)),alert("Error! @delete-form-no-1-calculation-quote-item-fitting-charge")}})}),$(document).on("submit","#form-no-1-calculation-quote-items-results .group-discount-form",function(e){e.preventDefault();var t=$(this),a=$(this).find("input[type='submit']"),o=isNaN(t.find(".group-discount").val())?"0":t.find(".group-discount").val(),n=isNaN(t.find(".group-total").val())?"0":t.find(".group-total").val(),l=t.find(".form-no-1-calculation-code").val(),i=(n-n*o/100).toFixed(2);$.ajax({url:"form-no-1-calculation/scripts/update-form-no-1-calculation-group-discount.php",type:"POST",dataType:"json",data:{cid:cid,discount:o,form_no_1_calculation_code:l},beforeSend:function(){a.prop("disabled",!1).addClass("field-loader")},success:function(e){4===e[0]?document.location.replace(e[1]):2===e[0]?(a.prop("disabled",!1).removeClass("field-loader"),alert(e[1])):1===e[0]?(t.siblings(".group-discount-total").html(i),a.prop("disabled",!1).removeClass("field-loader")):(a.prop("disabled",!1).removeClass("field-loader"),alert(JSON.stringify(e))),$("#getsum").load("getsum.php?cid="+cid).fadeIn("fast"),$("#totalx").load("megaTotal.php?cid="+cid).fadeIn("fast")},error:function(e,t,o){a.prop("disabled",!1).removeClass("field-loader"),alert(JSON.stringify(e)),alert("Error! @update-form-no-1-calculation-group-discount")}})});